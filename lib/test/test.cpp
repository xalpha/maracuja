#include <assert.h>
#include <iostream>
#include <maracuja/MSImage.hpp>


template <typename T, typename Ti>
maracuja::MSImage initImage()
{
    // init stuff
    maracuja::MSImage<T> imageMS;
    imageMS.clear();

    // Sensitivity
    typename maracuja::Spectrum<T>::VectorX Sensitivity(551);
    Sensitivity << 0, 0, 0, 0.248571428571429, 0.251278195488722, 0.254436090225564, 0.257593984962406, 0.260751879699248, 0.263909774436090, 0.267518796992481, 0.270225563909775, 0.273834586466166, 0.277443609022556, 0.280150375939850, 0.283759398496241, 0.286466165413534, 0.290075187969925, 0.294702966206726, 0.300128893662728, 0.303782533256218, 0.306766917293233, 0.309924812030075, 0.313082706766917, 0.316240601503759, 0.319849624060150, 0.322556390977444, 0.326165413533835, 0.329323308270677, 0.332481203007519, 0.336090225563910, 0.338796992481203, 0.341954887218045, 0.345503759398496, 0.348270676691729, 0.352330827067669, 0.354586466165414, 0.357808807733620, 0.360902255639098, 0.363609022556391, 0.366766917293233, 0.369022556390978, 0.372631578947369, 0.375789473684211, 0.378947368421053, 0.381654135338346, 0.383909774436090, 0.386616541353384, 0.389323308270677, 0.392030075187970, 0.393383458646617, 0.397890635680109, 0.403578947368421, 0.405112781954887, 0.406466165413534, 0.409624060150376, 0.411879699248120, 0.414586466165414, 0.416842105263158, 0.418646616541354, 0.421804511278196, 0.423157894736842, 0.426315789473684, 0.428120300751880, 0.430375939849624, 0.432631578947369, 0.434887218045113, 0.437593984962406, 0.438947368421053, 0.441203007518797, 0.443458646616541, 0.445714285714286, 0.447969924812030, 0.449323308270677, 0.451578947368421, 0.453834586466166, 0.455639097744361, 0.456992481203008, 0.459248120300752, 0.461503759398496, 0.463308270676692, 0.465112781954887, 0.467368421052632, 0.469624060150376, 0.471654135338346, 0.474586466165414, 0.476390977443609, 0.477744360902256, 0.479548872180451, 0.481353383458647, 0.483157894736842, 0.484511278195489, 0.485864661654135, 0.487669172932331, 0.489022556390978, 0.490827067669173, 0.492180451127820, 0.493533834586466, 0.494436090225564, 0.495338345864662, 0.496992481203008, 0.499142857142857, 0.499142857142857, 0.501293233082707, 0.503007518796993, 0.503458646616541, 0.503458646616541, 0.504360902255639, 0.505263157894737, 0.505263157894737, 0.505714285714286, 0.506165413533835, 0.506616541353384, 0.506165413533835, 0.506165413533835, 0.506165413533835, 0.506165413533835, 0.506165413533835, 0.505488721804511, 0.505263157894737, 0.504812030075188, 0.504360902255639, 0.503458646616541, 0.503458646616541, 0.503007518796993, 0.502556390977444, 0.502105263157895, 0.501293233082707, 0.500751879699248, 0.500030075187970, 0.500030075187970, 0.499398496240602, 0.498766917293233, 0.498045112781955, 0.498045112781955, 0.498045112781955, 0.497503759398496, 0.497503759398496, 0.497503759398496, 0.496240601503760, 0.496240601503760, 0.495789473684211, 0.495789473684211, 0.495338345864662, 0.494887218045113, 0.494436090225564, 0.493533834586466, 0.493082706766917, 0.492180451127820, 0.491729323308271, 0.490827067669173, 0.489473684210526, 0.488571428571429, 0.487669172932331, 0.486766917293233, 0.485413533834587, 0.484060150375940, 0.483157894736842, 0.482255639097744, 0.481353383458647, 0.480451127819549, 0.479548872180451, 0.478646616541353, 0.477293233082707, 0.476842105263158, 0.475939849624060, 0.474586466165414, 0.473233082706767, 0.472330827067669, 0.471428571428572, 0.470526315789474, 0.469624060150376, 0.468721804511278, 0.467368421052632, 0.466015037593985, 0.465112781954887, 0.464210526315790, 0.462857142857143, 0.462406015037594, 0.461052631578947, 0.459699248120301, 0.458796992481203, 0.457894736842105, 0.456992481203008, 0.455187969924812, 0.453834586466166, 0.452481203007519, 0.451578947368421, 0.450225563909775, 0.449774436090226, 0.448421052631579, 0.447067669172932, 0.446616541353384, 0.445263157894737, 0.444360902255639, 0.443007518796993, 0.442556390977444, 0.441203007518797, 0.439849624060150, 0.438947368421053, 0.438045112781955, 0.436691729323308, 0.436691729323308, 0.435338345864662, 0.434436090225564, 0.433533834586466, 0.432631578947369, 0.431729323308271, 0.430827067669173, 0.429924812030075, 0.429022556390978, 0.427669172932331, 0.426766917293233, 0.425864661654135, 0.424962406015038, 0.424060150375940, 0.423609022556391, 0.422706766917293, 0.421353383458647, 0.420000000000000, 0.419097744360902, 0.418195488721805, 0.417293233082707, 0.416390977443609, 0.415488721804511, 0.414586466165414, 0.413684210526316, 0.412781954887218, 0.411879699248120, 0.410977443609023, 0.410075187969925, 0.409172932330827, 0.408270676691729, 0.407368421052632, 0.406466165413534, 0.405563909774436, 0.404661654135338, 0.403759398496241, 0.402857142857143, 0.401654135338346, 0.400451127819549, 0.399248120300752, 0.398045112781955, 0.396842105263158, 0.395187969924812, 0.394736842105263, 0.393834586466166, 0.392481203007519, 0.391578947368421, 0.390225563909775, 0.389323308270677, 0.387518796992481, 0.385263157894737, 0.384360902255639, 0.382556390977444, 0.381654135338346, 0.380300751879699, 0.378947368421053, 0.378045112781955, 0.376240601503760, 0.375338345864662, 0.373533834586466, 0.372180451127820, 0.370827067669173, 0.369473684210526, 0.367669172932331, 0.366315789473684, 0.364962406015038, 0.363609022556391, 0.361804511278196, 0.360902255639098, 0.359097744360902, 0.357744360902256, 0.355488721804511, 0.354586466165414, 0.353233082706767, 0.351428571428572, 0.349624060150376, 0.348270676691729, 0.346917293233083, 0.345112781954887, 0.343759398496241, 0.341954887218045, 0.340601503759399, 0.337894736842105, 0.335639097744361, 0.334285714285714, 0.332481203007519, 0.330676691729323, 0.329323308270677, 0.327518796992481, 0.326616541353384, 0.324360902255639, 0.322556390977444, 0.321654135338346, 0.319849624060150, 0.318045112781955, 0.316691729323308, 0.314887218045113, 0.313984962406015, 0.311729323308271, 0.309473684210526, 0.309473684210526, 0.307218045112782, 0.305413533834587, 0.304060150375940, 0.303157894736842, 0.300837808807734, 0.299097744360902, 0.296197636949517, 0.294586466165414, 0.293684210526316, 0.292330827067669, 0.290526315789474, 0.289172932330827, 0.287368421052632, 0.285112781954887, 0.283759398496241, 0.281052631578947, 0.278345864661654, 0.276541353383459, 0.274736842105263, 0.273383458646617, 0.271578947368421, 0.270225563909775, 0.268421052631579, 0.266165413533835, 0.264360902255639, 0.263007518796993, 0.261203007518797, 0.259398496240602, 0.257593984962406, 0.256691729323308, 0.254887218045113, 0.253082706766917, 0.251278195488722, 0.249924812030075, 0.247669172932331, 0.245864661654135, 0.244962406015038, 0.243157894736842, 0.241353383458647, 0.239548872180451, 0.238195488721805, 0.236390977443609, 0.235037593984962, 0.233684210526316, 0.231879699248120, 0.230526315789474, 0.229172932330827, 0.227368421052632, 0.225338345864662, 0.222857142857143, 0.221954887218045, 0.220150375939850, 0.218796992481203, 0.217443609022556, 0.216090225563910, 0.214736842105263, 0.212932330827068, 0.212030075187970, 0.210676691729323, 0.208872180451128, 0.207969924812030, 0.207067669172932, 0.205263157894737, 0.203909774436090, 0.203458646616541, 0.201428571428571, 0.200413533834587, 0.198882921589689, 0.196820622986037, 0.195789473684211, 0.194887218045113, 0.194436090225564, 0.192631578947368, 0.191278195488722, 0.190375939849624, 0.189022556390977, 0.187218045112782, 0.186766917293233, 0.185413533834586, 0.183609022556391, 0.183609022556391, 0.181353383458647, 0.179548872180451, 0.178646616541353, 0.177293233082707, 0.176390977443609, 0.175037593984962, 0.174135338345865, 0.172781954887218, 0.171879699248120, 0.170977443609023, 0.170075187969925, 0.168721804511278, 0.167368421052632, 0.166917293233083, 0.165563909774436, 0.164210526315790, 0.163759398496241, 0.162857142857143, 0.161729323308271, 0.160601503759399, 0.159248120300752, 0.158796992481203, 0.157443609022556, 0.156541353383459, 0.155639097744361, 0.155187969924812, 0.154285714285714, 0.153383458646617, 0.152481203007519, 0.151578947368421, 0.151127819548872, 0.150225563909774, 0.149323308270677, 0.148421052631579, 0.147293233082707, 0.146165413533835, 0.145263157894737, 0.144812030075188, 0.143458646616541, 0.143458646616541, 0.142556390977444, 0.141654135338346, 0.141654135338346, 0.139849624060150, 0.139849624060150, 0.138947368421053, 0.138496240601504, 0.137593984962406, 0.137142857142857, 0.136240601503759, 0.135338345864662, 0.134887218045113, 0.133533834586466, 0.133533834586466, 0.132631578947368, 0.131729323308271, 0.131278195488722, 0.129924812030075, 0.129924812030075, 0.129022556390977, 0.128120300751880, 0.127669172932331, 0.126766917293233, 0.125413533834586, 0.124962406015038, 0.124511278195489, 0.123609022556391, 0.122481203007519, 0.121353383458647, 0.120451127819549, 0.119548872180451, 0.118646616541353, 0.117744360902256, 0.116842105263158, 0.115939849624060, 0.115037593984962, 0.114135338345865, 0.113233082706767, 0.112330827067669, 0.111428571428571, 0.110526315789474, 0.109624060150376, 0.109172932330827, 0.107819548872180, 0.107368421052632, 0.106015037593985, 0.105563909774436, 0.103759398496241, 0.103308270676692, 0.103308270676692, 0.102105263157895, 0.100902255639098, 0.0996992481203007, 0.0984962406015038, 0.0965413533834587, 0.0960902255639098, 0.0956390977443610, 0.0951879699248120, 0.0942857142857143, 0.0933834586466166, 0.0920300751879700, 0.0906766917293234, 0.0897744360902256, 0.0888721804511279, 0.0879699248120301, 0.0866165413533835, 0.0866165413533835, 0.0848120300751880, 0.0843609022556391, 0.0834586466165413, 0.0830075187969925, 0.0821052631578948, 0.0812030075187971, 0.0803007518796993, 0.0798496240601504, 0.0789473684210527, 0.0780451127819549, 0.0775939849624060, 0.0766917293233083, 0.0757894736842105, 0.0753383458646617, 0.0748872180451128, 0.0739849624060150, 0.0730827067669173, 0.0726315789473685, 0.0721804511278196, 0.0712781954887218, 0.0708270676691729, 0.0703759398496241, 0.0694736842105264, 0.0690225563909774, 0.0685714285714286, 0.0676691729323309, 0.0672180451127820, 0.0663157894736843, 0.0658646616541354, 0.0649624060150377, 0.0645112781954887, 0.0640601503759398, 0.0636090225563910, 0.0631578947368421, 0.0622556390977443, 0.0613533834586466, 0.0613533834586466, 0.0604511278195489, 0.0604511278195489, 0.0595488721804511, 0.0595488721804511, 0.0586466165413534, 0.0586466165413534, 0.0577443609022557, 0.0572932330827067, 0.0568421052631579, 0.0559398496240602, 0.0554887218045113, 0.0550375939849624, 0.0550375939849624, 0.0541353383458647, 0.0541353383458647, 0.0532330827067670, 0.0527819548872180, 0.0523308270676692, 0.0518796992481203, 0.0514285714285715, 0.0505263157894738, 0.0505263157894738, 0.0496240601503759, 0.0491729323308270;
    maracuja::Spectrum<T> SensitSpectrum;
    SensitSpectrum.set(400, 950, Sensitivity);

    // Filters
    typename maracuja::Spectrum<T>::VectorX Filter1(551);
    Filter1 << 0.480610504200000, 0.481150550800000, 0.481869354200000, 0.483012580900000, 0.483803978000000, 0.484906234700000, 0.486323547400000, 0.487385940600000, 0.488922233600000, 0.488309753400000, 0.488286598200000, 0.488982353200000, 0.484850349400000, 0.475781784100000, 0.460184707600000, 0.437950935400000, 0.406959343000000, 0.368429260300000, 0.324199333200000, 0.277357692700000, 0.231475715600000, 0.188953704800000, 0.151315126400000, 0.119803066300000, 0.0937653350800000, 0.0731791257900000, 0.0570456218700000, 0.0445695495600000, 0.0350337290800000, 0.0275680851900000, 0.0218930697400000, 0.0175243425400000, 0.0141054821000000, 0.0114533329000000, 0.00935966253300000, 0.00767080068600000, 0.00632954537900000, 0.00520152151600000, 0.00426660478100000, 0.00347497075800000, 0.00279554247900000, 0.00221557498000000, 0.00171665549300000, 0.00130597814900000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    maracuja::Spectrum<T> F1Spectrum;
    F1Spectrum.set(400, 950, Filter1);
    maracuja::Channel<T,Ti> F1Channel;
    F1Channel.set(0, F1Spectrum, SensitSpectrum, "Filter 0: 400nm");
    imageMS.addChannel(F1Channel);

    typename maracuja::Spectrum<T>::VectorX Filter2(551);
    Filter2 << 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00146204203400000, 0.00315466016500000, 0.00678514123000000, 0.0143643808400000, 0.0300173306500000, 0.0596992111200000, 0.110091600400000, 0.181809520700000, 0.263378257800000, 0.337606048600000, 0.390636520400000, 0.426546554600000, 0.459470214800000, 0.501245803800000, 0.554974746700000, 0.616252174400000, 0.670852127100000, 0.706304473900000, 0.719801178000000, 0.717603530900000, 0.711896514900000, 0.710831527700000, 0.716983642600000, 0.728174285900000, 0.739736938500000, 0.747461700400000, 0.749691391000000, 0.746639938400000, 0.739436035200000, 0.729354629500000, 0.715807189900000, 0.698984985400000, 0.679526138300000, 0.658287506100000, 0.637554359400000, 0.620818557700000, 0.610143661500000, 0.606950569200000, 0.611126060500000, 0.619224433900000, 0.625530548100000, 0.621171188400000, 0.595484390300000, 0.543018417400000, 0.465607452400000, 0.375118370100000, 0.283364982600000, 0.203124275200000, 0.139681663500000, 0.0939799213400000, 0.0625847864200000, 0.0411968135800000, 0.0271958971000000, 0.0180801057800000, 0.0120595753200000, 0.00811973094900000, 0.00552618205500000, 0.00380207508800000, 0.00265549480900000, 0.00186753943600000, 0.00133273243900000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    maracuja::Spectrum<T> F2Spectrum;
    F2Spectrum.set(400, 950, Filter2);
    maracuja::Channel<T,Ti> F2Channel;
    F2Channel.set(1, F2Spectrum, SensitSpectrum, "Filter 1: 450nm");
    imageMS.addChannel(F2Channel);

    typename maracuja::Spectrum<T>::VectorX Filter3(551);
    Filter3 << 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00122505091100000, 0.00244666293300000, 0.00501194953900000, 0.0104630351100000, 0.0219941854500000, 0.0462253284500000, 0.0946668529500000, 0.180547065700000, 0.305938835100000, 0.447611923200000, 0.570035934400000, 0.641070327800000, 0.669430542000000, 0.674656066900000, 0.671306991600000, 0.667128295900000, 0.666352462800000, 0.670495224000000, 0.679106903100000, 0.691448745700000, 0.705677566500000, 0.719779663100000, 0.732710723900000, 0.742596893300000, 0.748927688600000, 0.751937484700000, 0.752867507900000, 0.752254104600000, 0.750877990700000, 0.750139389000000, 0.749361343400000, 0.749530563400000, 0.749867706300000, 0.749796600300000, 0.749592285200000, 0.747948837300000, 0.745149536100000, 0.740310211200000, 0.734094390900000, 0.725658187900000, 0.715704650900000, 0.703255081200000, 0.689470977800000, 0.674533538800000, 0.658859481800000, 0.644877166700000, 0.633101272600000, 0.624691848800000, 0.616581802400000, 0.594958305400000, 0.537778091400000, 0.432275695800000, 0.295466480300000, 0.173660545300000, 0.0780722284300000, 0.0458301639600000, 0.0232101893400000, 0.0119428002800000, 0.00635969102400000, 0.00350937217500000, 0.00201128602000000, 0.00118885070100000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    maracuja::Spectrum<T> F3Spectrum;
    F3Spectrum.set(400, 950, Filter3);
    maracuja::Channel<T,Ti> F3Channel;
    F3Channel.set(2, F3Spectrum, SensitSpectrum, "Filter 2: 500nm");
    imageMS.addChannel(F3Channel);

    typename maracuja::Spectrum<T>::VectorX Filter4(551);
    Filter4 << 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00146227508800000, 0.00227412328100000, 0.00363548457600000, 0.00594405829900000, 0.00996797561600000, 0.0171008741900000, 0.0301526927900000, 0.0556089782700000, 0.104272470500000, 0.190821495100000, 0.312971706400000, 0.431185417200000, 0.499341125500000, 0.507570266700000, 0.488546867400000, 0.471195983900000, 0.465869026200000, 0.472625923200000, 0.489141922000000, 0.512515487700000, 0.540489616400000, 0.571140174900000, 0.602469635000000, 0.631372795100000, 0.655965499900000, 0.674461746200000, 0.686140213000000, 0.690967636100000, 0.690300598100000, 0.685872650100000, 0.679007949800000, 0.670642166100000, 0.661679077100000, 0.652571106000000, 0.644729919400000, 0.639499893200000, 0.638314895600000, 0.641475677500000, 0.648160095200000, 0.656032028200000, 0.661479263300000, 0.661303405800000, 0.653197479200000, 0.636560249300000, 0.613830757100000, 0.587445755000000, 0.558088111900000, 0.523640403700000, 0.479808502200000, 0.420853271500000, 0.346889152500000, 0.267182502700000, 0.192858486200000, 0.132804689400000, 0.0892383289300000, 0.0593049383200000, 0.0394389033300000, 0.0265750312800000, 0.0183033645200000, 0.0127608633000000, 0.00909321844600000, 0.00661062002200000, 0.00488646805300000, 0.00367302417800000, 0.00279440343400000, 0.00215202689200000, 0.00167861923600000, 0.00132178753600000, 0.00104838654400000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    maracuja::Spectrum<T> F4Spectrum;
    F4Spectrum.set(400, 950, Filter4);
    maracuja::Channel<T,Ti> F4Channel;
    F4Channel.set(3, F4Spectrum, SensitSpectrum, "Filter 3: 550nm");
    imageMS.addChannel(F4Channel);

    typename maracuja::Spectrum<T>::VectorX Filter5(551);
    Filter5 << 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00105003178100000, 0.00102949805600000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00131782531700000, 0.00192825421700000, 0.00289690613700000, 0.00448208808900000, 0.00715082407000000, 0.0117741382100000, 0.0204212141000000, 0.0370717096300000, 0.0710173034700000, 0.141418056500000, 0.274617614700000, 0.471901512100000, 0.656702117900000, 0.736180877700000, 0.712076568600000, 0.654398345900000, 0.612482719400000, 0.596374168400000, 0.601851577800000, 0.622440338100000, 0.651477661100000, 0.684079437300000, 0.715680542000000, 0.742244339000000, 0.762263488800000, 0.774789733900000, 0.779908752400000, 0.778395614600000, 0.772097930900000, 0.761940155000000, 0.748262558000000, 0.732323684700000, 0.715332412700000, 0.697565765400000, 0.680449066200000, 0.664925231900000, 0.651306991600000, 0.640553588900000, 0.632725639300000, 0.628119659400000, 0.626316490200000, 0.625401001000000, 0.622365188600000, 0.612033653300000, 0.587359504700000, 0.540656738300000, 0.469145965600000, 0.380325889600000, 0.287942161600000, 0.206346111300000, 0.141379547100000, 0.0949416065200000, 0.0633775758700000, 0.0425242996200000, 0.0288586139700000, 0.0197964084100000, 0.0138129723100000, 0.00981921255600000, 0.00705643117400000, 0.00515846610100000, 0.00382257223100000, 0.00286383777900000, 0.00218161016700000, 0.00167434170800000, 0.00130222708000000, 0.00102467663600000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    maracuja::Spectrum<T> F5Spectrum;
    F5Spectrum.set(400, 950, Filter5);
    maracuja::Channel<T,Ti> F5Channel;
    F5Channel.set(4, F5Spectrum, SensitSpectrum, "Filter 4: 600nm");
    imageMS.addChannel(F5Channel);

    typename maracuja::Spectrum<T>::VectorX Filter6(551);
    Filter6 << 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00107889875800000, 0.00149064496200000, 0.00209594652100000, 0.00300988256900000, 0.00441726863400000, 0.00659322619400000, 0.0101633358000000, 0.0160873293900000, 0.0263496112800000, 0.0447834539400000, 0.0783147954900000, 0.140912723500000, 0.248939514200000, 0.405202179000000, 0.575555152900000, 0.697319870000000, 0.735127182000000, 0.712117538500000, 0.674790191700000, 0.646312027000000, 0.632586822500000, 0.631464538600000, 0.639795761100000, 0.653236084000000, 0.668837509200000, 0.683345565800000, 0.694527511600000, 0.701081008900000, 0.702214508100000, 0.698596801800000, 0.690368194600000, 0.679033126800000, 0.666421127300000, 0.653199996900000, 0.641317749000000, 0.631291618300000, 0.624430770900000, 0.621520805400000, 0.622645683300000, 0.628179664600000, 0.638518142700000, 0.653156662000000, 0.671820526100000, 0.693387527500000, 0.716252594000000, 0.737640762300000, 0.752605972300000, 0.754939270000000, 0.735817337000000, 0.687902679400000, 0.608017845200000, 0.503586463900000, 0.390007438700000, 0.285101528200000, 0.200377254500000, 0.136356086700000, 0.0921047973600000, 0.0622258615500000, 0.0422894620900000, 0.0290302157400000, 0.0201215887100000, 0.0141591131700000, 0.0101546239900000, 0.00739957571000000, 0.00546510815600000, 0.00408280313000000, 0.00308833301100000, 0.00237126037500000, 0.00182706460400000, 0.00142351940300000, 0.00112091042100000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    maracuja::Spectrum<T> F6Spectrum;
    F6Spectrum.set(400, 950, Filter6);
    maracuja::Channel<T,Ti> F6Channel;
    F6Channel.set(5, F6Spectrum, SensitSpectrum, "Filter 5: 650nm");
    imageMS.addChannel(F6Channel);

    typename maracuja::Spectrum<T>::VectorX Filter7(551);
    Filter7 << 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00127632319900000, 0.00173192843800000, 0.00237449303300000, 0.00331294775000000, 0.00470024287700000, 0.00676820874200000, 0.00994052529300000, 0.0149132418600000, 0.0229180526700000, 0.0360359072700000, 0.0575125837300000, 0.0938177490200000, 0.152961883500000, 0.245398349800000, 0.374134101900000, 0.520022621200000, 0.649666290300000, 0.729986572300000, 0.759654998800000, 0.757423172000000, 0.743989868200000, 0.730738830600000, 0.722248992900000, 0.719275360100000, 0.719700241100000, 0.722403793300000, 0.725859832800000, 0.729186554000000, 0.731548461900000, 0.732095260600000, 0.731598205600000, 0.729810562100000, 0.727182235700000, 0.723612136800000, 0.719819870000000, 0.716712799100000, 0.713155441300000, 0.710857162500000, 0.709262237500000, 0.708332748400000, 0.708736801100000, 0.709554595900000, 0.711636734000000, 0.714858093300000, 0.718769989000000, 0.723815078700000, 0.730378189100000, 0.737973785400000, 0.744743423500000, 0.747846221900000, 0.741374969500000, 0.716235199000000, 0.663682632400000, 0.579788322400000, 0.474308662400000, 0.363348884600000, 0.263146457700000, 0.182183132200000, 0.123501424800000, 0.0837004947700000, 0.0567161274000000, 0.0389788484600000, 0.0271691632300000, 0.0191923749400000, 0.0138173782800000, 0.0100555264900000, 0.00743013083900000, 0.00555888116400000, 0.00420986115900000, 0.00323173075900000, 0.00249908909200000, 0.00195686981100000, 0.00154523730300000, 0.00123379252900000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    maracuja::Spectrum<T> F7Spectrum;
    F7Spectrum.set(400, 950, Filter7);
    maracuja::Channel<T,Ti> F7Channel;
    F7Channel.set(6, F7Spectrum, SensitSpectrum, "Filter 6: 700nm");
    imageMS.addChannel(F7Channel);

    typename maracuja::Spectrum<T>::VectorX Filter8(551);
    Filter8 << 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00105382911900000, 0.00159694656700000, 0.00247014030800000, 0.00394650220900000, 0.00658716023000000, 0.0115133249800000, 0.0213277459100000, 0.0428206968300000, 0.0907396793400000, 0.192917709400000, 0.357962913500000, 0.509839286800000, 0.555303382900000, 0.504475059500000, 0.439482078600000, 0.400928993200000, 0.390813713100000, 0.402896537800000, 0.432635040300000, 0.475356712300000, 0.529320106500000, 0.587106246900000, 0.642706680300000, 0.689609375000000, 0.724999389600000, 0.748338546800000, 0.762060394300000, 0.769339523300000, 0.773963241600000, 0.777074050900000, 0.779376297000000, 0.781450653100000, 0.782004928600000, 0.780621719400000, 0.777152862500000, 0.772045822100000, 0.765675048800000, 0.759163284300000, 0.752983856200000, 0.748093109100000, 0.745259017900000, 0.742887039200000, 0.741512680100000, 0.739649200400000, 0.736681366000000, 0.730802383400000, 0.720295105000000, 0.703277053800000, 0.673616485600000, 0.624967346200000, 0.550945472700000, 0.456644210800000, 0.352769508400000, 0.253122749300000, 0.172791156800000, 0.114041261700000, 0.0741702604300000, 0.0483103370700000, 0.0318098259000000, 0.0212375736200000, 0.0144349885000000, 0.00997504055500000, 0.00699718594600000, 0.00498628020300000, 0.00361153632400000, 0.00266102612000000, 0.00197867006100000, 0.00149165257800000, 0.00113861404400000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    maracuja::Spectrum<T> F8Spectrum;
    F8Spectrum.set(400, 950, Filter8);
    maracuja::Channel<T,Ti> F8Channel;
    F8Channel.set(7, F8Spectrum, SensitSpectrum, "Filter 7: 750nm");
    imageMS.addChannel(F8Channel);

    typename maracuja::Spectrum<T>::VectorX Filter9(551);
    Filter9 << 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00128793373700000, 0.00179064780500000, 0.00251339674000000, 0.00357786238200000, 0.00521469533400000, 0.00770527482000000, 0.0116020798700000, 0.0178734695900000, 0.0280551195100000, 0.0450587558700000, 0.0737791633600000, 0.121070900000000, 0.195939159400000, 0.304529972100000, 0.439925308200000, 0.576995239300000, 0.685342407200000, 0.754576644900000, 0.787847518900000, 0.801781692500000, 0.805984344500000, 0.807803955100000, 0.807257995600000, 0.807233200100000, 0.805429306000000, 0.803118743900000, 0.799777984600000, 0.796211624100000, 0.793897628800000, 0.791738281300000, 0.785050888100000, 0.783969268800000, 0.782764511100000, 0.779291534400000, 0.774793243400000, 0.768504562400000, 0.758864135700000, 0.746743698100000, 0.730831298800000, 0.713307876600000, 0.693160934400000, 0.672017669700000, 0.650943374600000, 0.633826026900000, 0.619103241000000, 0.607291030900000, 0.596301956200000, 0.584064674400000, 0.568451271100000, 0.549421234100000, 0.526183052100000, 0.496397476200000, 0.460256500200000, 0.415806579600000, 0.366697998000000, 0.319324798600000, 0.277104225200000, 0.240270023300000, 0.208744869200000, 0.183606529200000, 0.160814380600000, 0.141282901800000, 0.125682458900000, 0.112276573200000, 0.0986166381800000, 0.0841775131200000, 0.0707104301500000, 0.0582929945000000, 0.0473422908800000, 0.0376969862000000, 0.0290673303600000, 0.0217853641500000, 0.0155173850100000, 0.0104010617700000, 0.00657099068200000, 0.00405022442300000, 0.00251605182900000, 0.00159174934000000, 0.00107269078500000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    maracuja::Spectrum<T> F9Spectrum;
    F9Spectrum.set(400, 950, Filter9);
    maracuja::Channel<T,Ti> F9Channel;
    F9Channel.set(8, F9Spectrum, SensitSpectrum, "Filter 8: 800nm");
    imageMS.addChannel(F9Channel);

    typename maracuja::Spectrum<T>::VectorX Filter10(551);
    Filter10 << 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00146128043500000, 0.00246054112900000, 0.00415280729500000, 0.00692803800100000, 0.0111086893100000, 0.0170590353000000, 0.0243831920600000, 0.0331512737300000, 0.0431006765400000, 0.0537262249000000, 0.0660038805000000, 0.0801821041100000, 0.0956482410400000, 0.113027887300000, 0.132419023500000, 0.153848190300000, 0.176384067500000, 0.203192482000000, 0.235913391100000, 0.272241630600000, 0.317417373700000, 0.367812767000000, 0.419797020000000, 0.469336166400000, 0.511705207800000, 0.544606399500000, 0.568605728100000, 0.586778030400000, 0.599159698500000, 0.609427948000000, 0.621191330000000, 0.635307846100000, 0.652177200300000, 0.669734726000000, 0.685923996000000, 0.699719696000000, 0.711255111700000, 0.719391632100000, 0.723696823100000, 0.727486343400000, 0.729857482900000, 0.730959625200000, 0.732409896900000, 0.733117828400000, 0.733862915000000, 0.734493026700000, 0.733977584800000, 0.733471679700000, 0.731532287600000, 0.730010757400000, 0.728344879200000, 0.726686630200000, 0.725596008300000, 0.726872100800000, 0.728514404300000, 0.728029327400000, 0.720641250600000, 0.700706634500000, 0.658830947900000, 0.595476379400000, 0.517022247300000, 0.432866439800000, 0.351859626800000, 0.283616924300000, 0.229442462900000, 0.186150779700000, 0.152761507000000, 0.127132844900000, 0.105610446900000, 0.0886255359600000, 0.0753198242200000, 0.0648734808000000, 0.0583554601700000, 0.0501028919200000, 0.0404668951000000, 0.0291467547400000, 0.0203587913500000, 0.0134728419800000, 0.00865882754300000, 0.00548264682300000, 0.00352293849000000, 0.00227137073900000, 0.00152020722600000, 0.00105714097600000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    maracuja::Spectrum<T> F10Spectrum;
    F10Spectrum.set(400, 950, Filter10);
    maracuja::Channel<T,Ti> F10Channel;
    F10Channel.set(9, F10Spectrum, SensitSpectrum, "Filter 9: 880nm");
    imageMS.addChannel(F10Channel);

    return imageMS;
}


template <typename T, typename Ti>
void toRGB( const std::string& filename )
{
    // init stuff
    maracuja::MSImage img = initImage();
    std::string baseFilename = filename.substr( 0, filename.find_last_of('-') );

    // set the filenames
    std::vector<std::string> suffixes;
    suffixes.push_back("-400nm.png");
    suffixes.push_back("-450nm.png");
    suffixes.push_back("-500nm.png");
    suffixes.push_back("-550nm.png");
    suffixes.push_back("-600nm.png");
    suffixes.push_back("-650nm.png");
    suffixes.push_back("-700nm.png");
    suffixes.push_back("-750nm.png");
    suffixes.push_back("-800nm.png");
    suffixes.push_back("-880nm.png");

    // load channels
    std::vector< std::shared_ptr<typename maracuja::Channel<T,Ti>::Image > > channels(10);
    for( size_t i=0; i<channels.size(); i++ )
    {
        channels[i] = std::shared_ptr<typename maracuja::Channel<T,Ti>::Image >( new typename maracuja::Channel<T,Ti>::Image );
        channels[i]->load( (baseFilename + suffixes[i]).c_str() );
    }

    // add the channels to the MSImage
    for( size_t i=0; i<channels.size(); i++ )
        img.setImage( i, channels[i] );

    // init the spectra for RGB
    typename maracuja::Spectrum<T>::VectorX R(551);
    R << 0.524911032028469, 0.542704626334519, 0.542704626334519, 0.542704626334519, 0.542704626334519, 0.542704626334519, 0.542704626334519, 0.551601423487544, 0.542704626334519, 0.542704626334519, 0.542704626334519, 0.542704626334519, 0.542704626334519, 0.533807829181495, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.533807829181495, 0.542704626334519, 0.533807829181495, 0.560498220640569, 0.560498220640569, 0.578291814946619, 0.587188612099644, 0.604982206405693, 0.622775800711743, 0.640569395017793, 0.658362989323843, 0.676156583629893, 0.685053380782918, 0.693950177935943, 0.702846975088968, 0.711743772241992, 0.738434163701068, 0.738434163701068, 0.756227758007117, 0.756227758007117, 0.765124555160142, 0.765124555160142, 0.756227758007117, 0.756227758007117, 0.756227758007117, 0.742882562277579, 0.729537366548042, 0.711743772241992, 0.693950177935943, 0.658362989323843, 0.622775800711743, 0.604982206405693, 0.569395017793594, 0.533807829181495, 0.498220640569395, 0.462633451957295, 0.404804270462633, 0.404804270462633, 0.346975088967971, 0.311387900355872, 0.275800711743772, 0.240213523131672, 0.204626334519572, 0.177935943060498, 0.142348754448398, 0.115658362989324, 0.0800711743772240, 0.0622775800711741, 0.0266903914590744, 0.0177935943060494, 0.00889679715302449, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0978647686832739, 0.142348754448398, 0.213523131672598, 0.293594306049822, 0.382562277580071, 0.480427046263345, 0.603005140371688, 0.676156583629893, 0.782918149466192, 0.871886120996441, 0.968762356662713, 1.05871886120996, 1.16548042704626, 1.20996441281139, 1.30782918149466, 1.40569395017794, 1.51245551601423, 1.61032028469751, 1.71708185053381, 1.79715302491103, 1.89679715302491, 1.95507117437722, 2.03736654804270, 2.08185053380783, 2.15302491103203, 2.15302491103203, 2.22419928825623, 2.24199288256228, 2.25978647686833, 2.31316725978648, 2.34875444839858, 2.39323843416370, 2.41992882562278, 2.45551601423488, 2.48220640569395, 2.50889679715302, 2.54448398576512, 2.57413997627521, 2.59786476868327, 2.63345195729537, 2.65124555160142, 2.68683274021352, 2.70462633451957, 2.71352313167260, 2.73131672597865, 2.74911032028470, 2.76690391459075, 2.77580071174377, 2.79359430604982, 2.80249110320285, 2.82028469750890, 2.82028469750890, 2.82918149466192, 2.83807829181495, 2.82918149466192, 2.82918149466192, 2.82918149466192, 2.82028469750890, 2.82028469750890, 2.82028469750890, 2.82028469750890, 2.80249110320285, 2.80249110320285, 2.79804270462633, 2.79359430604982, 2.78469750889680, 2.78469750889680, 2.77580071174377, 2.76690391459075, 2.76690391459075, 2.74911032028470, 2.74911032028470, 2.74911032028470, 2.74021352313167, 2.73131672597865, 2.73131672597865, 2.73131672597865, 2.73131672597865, 2.73131672597865, 2.72241992882562, 2.71352313167260, 2.71352313167260, 2.71352313167260, 2.71352313167260, 2.71352313167260, 2.69572953736655, 2.69572953736655, 2.69572953736655, 2.69572953736655, 2.69572953736655, 2.67793594306050, 2.67793594306050, 2.67793594306050, 2.67793594306050, 2.66014234875445, 2.66014234875445, 2.66014234875445, 2.66014234875445, 2.65569395017794, 2.65124555160142, 2.64234875444840, 2.64234875444840, 2.63345195729537, 2.62455516014235, 2.62455516014235, 2.60676156583630, 2.60676156583630, 2.60676156583630, 2.58896797153025, 2.58896797153025, 2.58896797153025, 2.57117437722420, 2.57117437722420, 2.57117437722420, 2.56227758007117, 2.55338078291815, 2.55338078291815, 2.55338078291815, 2.53558718861210, 2.53558718861210, 2.52669039145907, 2.51779359430605, 2.51779359430605, 2.50889679715302, 2.50000000000000, 2.50000000000000, 2.49110320284698, 2.48220640569395, 2.48220640569395, 2.47330960854093, 2.46441281138790, 2.46441281138790, 2.45551601423488, 2.45106761565836, 2.44661921708185, 2.44661921708185, 2.42882562277580, 2.42882562277580, 2.42882562277580, 2.41992882562278, 2.41103202846975, 2.41103202846975, 2.41103202846975, 2.39323843416370, 2.39323843416370, 2.38434163701068, 2.37544483985765, 2.37544483985765, 2.36654804270463, 2.35765124555160, 2.35765124555160, 2.35765124555160, 2.35765124555160, 2.35765124555160, 2.34875444839858, 2.34875444839858, 2.34875444839858, 2.34875444839858, 2.34875444839858, 2.34875444839858, 2.33985765124555, 2.33985765124555, 2.33985765124555, 2.33985765124555, 2.33985765124555, 2.33985765124555, 2.33985765124555, 2.33985765124555, 2.33985765124555, 2.33985765124555, 2.33985765124555, 2.33985765124555, 2.33985765124555, 2.33985765124555, 2.33096085409253, 2.33096085409253, 2.32206405693950, 2.32206405693950, 2.32206405693950, 2.32206405693950, 2.32206405693950, 2.32206405693950, 2.32206405693950, 2.32206405693950, 2.32206405693950, 2.31316725978648, 2.30427046263345, 2.30427046263345, 2.30427046263345, 2.30427046263345, 2.30427046263345, 2.30427046263345, 2.30427046263345, 2.28647686832740, 2.28647686832740, 2.28647686832740, 2.28647686832740, 2.28647686832740, 2.27758007117438, 2.26868327402135, 2.26868327402135, 2.26868327402135, 2.26868327402135, 2.25088967971530, 2.25088967971530, 2.25088967971530, 2.25088967971530, 2.24199288256228, 2.23309608540925, 2.23309608540925, 2.23309608540925, 2.23309608540925, 2.21530249110320, 2.21530249110320, 2.20640569395018, 2.19750889679715, 2.19750889679715, 2.19750889679715, 2.17971530249110, 2.17971530249110, 2.16192170818505, 2.16192170818505, 2.16192170818505, 2.16192170818505, 2.14412811387900, 2.14412811387900, 2.14412811387900, 2.13523131672598, 2.12633451957295, 2.12633451957295, 2.12633451957295, 2.12633451957295, 2.10854092526690, 2.10854092526690, 2.10854092526690, 2.09074733096085, 2.09074733096085, 2.09074733096085, 2.09074733096085, 2.08185053380783, 2.07295373665480, 2.07295373665480, 2.07295373665480, 2.05516014234875, 2.05516014234875, 2.05516014234875, 2.03736654804270, 2.03736654804270, 2.03736654804270, 2.02846975088968, 2.01957295373665, 2.01957295373665, 2.00177935943061, 2.00177935943061, 1.99288256227758, 1.99288256227758, 1.99288256227758, 1.95729537366548, 1.95284697508897, 1.94839857651246, 1.94839857651246, 1.93950177935943, 1.93060498220641, 1.91281138790036, 1.91281138790036, 1.89501779359431, 1.88612099644128, 1.87722419928826, 1.86832740213523, 1.85943060498221, 1.84163701067616, 1.84163701067616, 1.82384341637011, 1.80604982206406, 1.80604982206406, 1.80604982206406, 1.78825622775801, 1.77935943060498, 1.77046263345196, 1.75266903914591, 1.74377224199288, 1.73487544483986, 1.71708185053381, 1.70818505338078, 1.69928825622776, 1.68149466192171, 1.67259786476868, 1.66370106761566, 1.64590747330961, 1.63701067615658, 1.62811387900356, 1.61032028469751, 1.60142348754448, 1.59252669039146, 1.57473309608541, 1.56583629893238, 1.55693950177936, 1.54804270462633, 1.53469750889680, 1.52135231316726, 1.50355871886121, 1.49466192170818, 1.48576512455516, 1.48576512455516, 1.45907473309609, 1.45017793594306, 1.43238434163701, 1.42348754448399, 1.41459074733096, 1.39679715302491, 1.39234875444840, 1.38790035587189, 1.37900355871886, 1.36120996441281, 1.35231316725979, 1.34341637010676, 1.32562277580071, 1.30782918149466, 1.30782918149466, 1.29003558718861, 1.29003558718861, 1.27224199288256, 1.26334519572954, 1.23665480427046, 1.23665480427046, 1.21886120996441, 1.20996441281139, 1.20106761565836, 1.18327402135231, 1.17437722419929, 1.16548042704626, 1.14768683274021, 1.13879003558719, 1.12989323843416, 1.11209964412811, 1.10320284697509, 1.09430604982206, 1.08540925266904, 1.07651245551601, 1.05871886120996, 1.05871886120996, 1.04092526690391, 1.04092526690391, 1.02313167259786, 1.02313167259786, 1.01423487544484, 1.00533807829181, 1.00533807829181, 0.996441281138790, 0.996441281138790, 0.960854092526690, 0.951957295373665, 0.951957295373665, 0.934163701067615, 0.916370106761566, 0.916370106761566, 0.907473309608540, 0.898576512455516, 0.880782918149466, 0.880782918149466, 0.862989323843416, 0.854092526690391, 0.818505338078292, 0.845195729537366, 0.827402135231316, 0.827402135231316, 0.809608540925266, 0.809608540925266, 0.809608540925266, 0.791814946619216, 0.791814946619216, 0.774021352313167, 0.774021352313167, 0.774021352313167, 0.756227758007117, 0.756227758007117, 0.756227758007117, 0.738434163701068, 0.738434163701068, 0.738434163701068, 0.738434163701068, 0.738434163701068, 0.738434163701068, 0.720640569395018, 0.720640569395018, 0.720640569395018, 0.711743772241992, 0.702846975088968, 0.702846975088968, 0.702846975088968, 0.702846975088968, 0.685053380782918, 0.685053380782918, 0.685053380782918, 0.667259786476868, 0.667259786476868, 0.667259786476868, 0.667259786476868, 0;
    maracuja::Spectrum<T> RSpectrum;
    RSpectrum.set(400, 950, R);

    typename maracuja::Channel<T,Ti>::VectorX G(551);
    G << 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0177935943060490, 0.0355871886120989, 0.0800711743772240, 0.106761565836298, 0.142348754448398, 0.177935943060498, 0.222419928825622, 0.258007117437722, 0.302491103202846, 0.346975088967971, 0.409252669039145, 0.427046263345195, 0.489323843416369, 0.524911032028469, 0.578291814946619, 0.596085409252669, 0.667259786476868, 0.702846975088968, 0.774021352313167, 0.809608540925266, 0.889679715302491, 0.925266903914590, 1.01067615658363, 1.03024911032028, 1.04982206405694, 1.12989323843416, 1.18327402135231, 1.26334519572954, 1.32562277580071, 1.39679715302491, 1.46797153024911, 1.55693950177936, 1.61921708185053, 1.71708185053381, 1.76156583629893, 1.87722419928826, 1.92425012709710, 2.04626334519573, 2.10854092526690, 2.20640569395018, 2.25978647686833, 2.36654804270463, 2.42882562277580, 2.50000000000000, 2.53558718861210, 2.66903914590747, 2.66192170818505, 2.74911032028470, 2.79359430604982, 2.84697508896797, 2.89145907473310, 2.92704626334520, 2.94483985765125, 2.97153024911032, 2.98932384341637, 2.99822064056939, 3.01601423487544, 3.03380782918149, 3.03380782918149, 3.03380782918149, 3.05160142348754, 3.06939501779359, 3.08718861209964, 3.08718861209964, 3.10498220640569, 3.10498220640569, 3.10498220640569, 3.12277580071174, 3.12277580071174, 3.12277580071174, 3.14056939501779, 3.14056939501779, 3.15836298932384, 3.15836298932384, 3.16725978647687, 3.17615658362989, 3.19395017793594, 3.19395017793594, 3.19395017793594, 3.21174377224199, 3.22953736654804, 3.22953736654804, 3.22953736654804, 3.22953736654804, 3.22953736654804, 3.22953736654804, 3.23843416370107, 3.23843416370107, 3.24733096085409, 3.24733096085409, 3.24733096085409, 3.23843416370107, 3.22953736654804, 3.22953736654804, 3.22953736654804, 3.22953736654804, 3.22953736654804, 3.19395017793594, 3.18505338078292, 3.16281138790036, 3.14056939501779, 3.11387900355872, 3.09608540925267, 3.06939501779359, 3.03380782918149, 3.00711743772242, 2.97153024911032, 2.92704626334520, 2.90035587188612, 2.85587188612100, 2.82028469750890, 2.78469750889680, 2.74911032028470, 2.69572953736655, 2.66903914590747, 2.61565836298932, 2.58896797153025, 2.54448398576512, 2.50889679715302, 2.45551601423488, 2.41992882562278, 2.35765124555160, 2.33096085409253, 2.26868327402135, 2.23309608540925, 2.16192170818505, 2.13523131672598, 2.07295373665480, 2.05516014234875, 2.03736654804270, 1.96441281138790, 1.92170818505338, 1.85943060498221, 1.80604982206406, 1.73487544483986, 1.69928825622776, 1.62811387900356, 1.59252669039146, 1.52135231316726, 1.48576512455516, 1.41459074733096, 1.37900355871886, 1.30782918149466, 1.26334519572954, 1.20106761565836, 1.15658362989324, 1.10320284697509, 1.06761565836299, 1.01423487544484, 0.956405693950178, 0.916370106761566, 0.871886120996441, 0.827402135231316, 0.791814946619216, 0.729537366548042, 0.693950177935943, 0.649466192170818, 0.622775800711743, 0.578291814946619, 0.533807829181495, 0.489323843416369, 0.453736654804270, 0.400355871886121, 0.373665480427046, 0.355871886120996, 0.338078291814946, 0.302491103202846, 0.284697508896797, 0.258007117437722, 0.240213523131672, 0.213523131672598, 0.142348754448398, 0.133451957295374, 0.106761565836298, 0.0889679715302485, 0.0622775800711741, 0.0533807829181487, 0.0355871886120989, 0.0266903914590744, 0.0133451957295367, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00889679715302449, 0.00889679715302449, 0.00889679715302449, 0.0177935943060490, 0.0266903914590744, 0.0266903914590744, 0.0266903914590744, 0.0355871886120989, 0.0444839857651242, 0.0444839857651242, 0.0444839857651242, 0.0622775800711741, 0.0622775800711741, 0.0622775800711741, 0.0800711743772240, 0.0978647686832739, 0.0978647686832739, 0.115658362989324, 0.115658362989324, 0.133451957295374, 0.133451957295374, 0.142348754448398, 0.151245551601423, 0.169039145907473, 0.177935943060498, 0.186832740213522, 0.204626334519572, 0.204626334519572, 0.213523131672598, 0.222419928825622, 0.240213523131672, 0.231316725978648, 0.249110320284697, 0.266903914590747, 0.266903914590747, 0.275800711743772, 0.284697508896797, 0.284697508896797, 0.293594306049822, 0.293594306049822, 0.293594306049822, 0.293594306049822, 0.302491103202846, 0.302491103202846, 0.302491103202846, 0.302491103202846, 0.302491103202846, 0.302491103202846, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.320284697508896, 0.329181494661921, 0.329181494661921, 0.346975088967971, 0.346975088967971, 0.346975088967971, 0.346975088967971, 0.346975088967971, 0.364768683274021, 0.364768683274021, 0.364768683274021, 0.373665480427046, 0.382562277580071, 0.382562277580071, 0.382562277580071, 0.400355871886121, 0.400355871886121, 0.400355871886121, 0.418149466192171, 0.418149466192171, 0.418149466192171, 0.435943060498221, 0.435943060498221, 0.444839857651245, 0.453736654804270, 0.453736654804270, 0.471530249110320, 0.489323843416369, 0.489323843416369, 0.489323843416369, 0.489323843416369, 0.507117437722419, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.542704626334519, 0.560498220640569, 0.560498220640569, 0.560498220640569, 0.578291814946619, 0.587188612099644, 0.596085409252669, 0.596085409252669, 0.613879003558719, 0.613879003558719, 0.622775800711743, 0.631672597864768, 0.631672597864768, 0.640569395017793, 0.649466192170818, 0.649466192170818, 0.667259786476868, 0.667259786476868, 0.667259786476868, 0.667259786476868, 0.685053380782918, 0.685053380782918, 0.693950177935943, 0.702846975088968, 0.702846975088968, 0.702846975088968, 0.676156583629893, 0.693950177935943, 0.711743772241992, 0.716192170818505, 0.720640569395018, 0.720640569395018, 0.729537366548042, 0.738434163701068, 0.738434163701068, 0.738434163701068, 0.738434163701068, 0.729537366548042, 0.729537366548042, 0.729537366548042, 0.729537366548042, 0.720640569395018, 0.720640569395018, 0.720640569395018, 0.711743772241992, 0.702846975088968, 0.702846975088968, 0.702846975088968, 0.702846975088968, 0.702846975088968, 0.702846975088968, 0.693950177935943, 0.685053380782918, 0.685053380782918, 0.667259786476868, 0.667259786476868, 0.667259786476868, 0.667259786476868, 0.649466192170818, 0.649466192170818, 0.631672597864768, 0.631672597864768, 0.631672597864768, 0.631672597864768, 0.622775800711743, 0.613879003558719, 0.613879003558719, 0.613879003558719, 0.596085409252669, 0.596085409252669, 0.596085409252669, 0.596085409252669, 0.587188612099644, 0.578291814946619, 0.578291814946619, 0.578291814946619, 0.560498220640569, 0.560498220640569, 0.560498220640569, 0.560498220640569, 0.560498220640569, 0.560498220640569, 0.551601423487544, 0.542704626334519, 0.542704626334519, 0.542704626334519, 0.542704626334519, 0.533807829181495, 0.529359430604982, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.516014234875445, 0.507117437722419, 0.507117437722419, 0.507117437722419, 0.507117437722419, 0.489323843416369, 0.489323843416369, 0.489323843416369, 0.489323843416369, 0.489323843416369, 0.489323843416369, 0.489323843416369, 0.480427046263345, 0.471530249110320, 0.462633451957295, 0.453736654804270, 0.453736654804270, 0.453736654804270, 0.453736654804270, 0.444839857651245, 0.435943060498221, 0.435943060498221, 0.435943060498221, 0.427046263345195, 0.418149466192171, 0.418149466192171, 0.418149466192171, 0.400355871886121, 0.400355871886121, 0.382562277580071, 0.382562277580071, 0.382562277580071, 0.382562277580071, 0.378113879003558, 0.373665480427046, 0.364768683274021, 0.364768683274021, 0.355871886120996, 0.346975088967971, 0.346975088967971, 0.346975088967971, 0.338078291814946, 0.329181494661921, 0.329181494661921, 0.329181494661921, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.293594306049822, 0.293594306049822, 0.293594306049822, 0.293594306049822, 0.275800711743772, 0.275800711743772, 0.275800711743772, 0.266903914590747, 0.258007117437722, 0.258007117437722, 0.258007117437722, 0.249110320284697, 0.240213523131672, 0.240213523131672, 0.240213523131672, 0.240213523131672, 0.240213523131672, 0.240213523131672, 0.231316725978647, 0.222419928825622, 0.222419928825622, 0.222419928825622, 0.222419928825622, 0.213523131672598, 0.213523131672598, 0.204626334519572, 0.204626334519572, 0.204626334519572, 0.204626334519572, 0.204626334519572, 0.186832740213522, 0.186832740213522, 0.186832740213522, 0.186832740213522, 0.186832740213522, 0.177935943060498, 0;
    maracuja::Spectrum<T> GSpectrum;
    GSpectrum.set(400, 950, G);

    typename maracuja::Channel<T,Ti>::VectorX B(551);
    B << 2.57117437722420, 2.67793594306050, 2.74021352313167, 2.77876631079478, 2.81731909845789, 2.86832740213523, 2.91814946619217, 2.97597864768683, 3.03380782918149, 3.08185053380783, 3.14946619217082, 3.18505338078292, 3.24436536180308, 3.29181494661922, 3.34163701067616, 3.37633451957295, 3.42526690391459, 3.44750889679715, 3.50533807829182, 3.53202846975089, 3.59074733096085, 3.62989323843416, 3.67437722419929, 3.70699881376038, 3.76868327402135, 3.80338078291815, 3.87010676156584, 3.90569395017794, 3.97508896797153, 4.01245551601424, 4.07473309608541, 4.12811387900356, 4.18446026097272, 4.24673784104389, 4.30604982206406, 4.35349940688019, 4.43060498220641, 4.46975088967972, 4.50578291814947, 4.54181494661922, 4.57651245551601, 4.63523131672598, 4.67081850533808, 4.71530249110320, 4.75088967971530, 4.77758007117438, 4.80427046263345, 4.83985765124555, 4.83096085409253, 4.83985765124555, 4.83985765124555, 4.83985765124555, 4.81316725978648, 4.79537366548043, 4.76868327402135, 4.71886120996441, 4.69395017793594, 4.63523131672598, 4.58007117437722, 4.52846975088968, 4.47508896797153, 4.41281138790036, 4.36832740213523, 4.30308422301305, 4.27935943060498, 4.19928825622776, 4.16014234875445, 4.08362989323843, 4.02728351126928, 3.93950177935943, 3.89679715302491, 3.83451957295374, 3.77817319098458, 3.71293001186240, 3.68742586002373, 3.66192170818505, 3.60320284697509, 3.55516014234875, 3.49644128113879, 3.44839857651246, 3.38967971530249, 3.34074733096085, 3.29181494661922, 3.24733096085409, 3.19395017793594, 3.15391459074733, 3.10320284697509, 3.05693950177936, 3.00711743772242, 2.96085409252669, 2.90925266903915, 2.86921708185053, 2.79715302491103, 2.75800711743772, 2.69572953736655, 2.67793594306050, 2.57117437722420, 2.55871886120996, 2.48220640569395, 2.45195729537367, 2.37010676156584, 2.33985765124555, 2.26868327402135, 2.21233689205219, 2.13523131672598, 2.07930859176411, 1.98102016607355, 1.91814946619217, 1.82680901542111, 1.81071004914421, 1.79461108286731, 1.70818505338078, 1.64590747330961, 1.55693950177936, 1.50991357397051, 1.41331977630910, 1.36756481952211, 1.28113879003559, 1.22521606507372, 1.14641586171835, 1.08540925266904, 1.01423487544484, 0.964412811387899, 0.907473309608540, 0.871886120996441, 0.804270462633451, 0.747330960854092, 0.707295373665480, 0.662811387900356, 0.622775800711743, 0.578291814946619, 0.516014234875445, 0.510083036773428, 0.462633451957295, 0.435943060498221, 0.400355871886121, 0.367734282325030, 0.338078291814946, 0.311387900355872, 0.275800711743772, 0.260972716488730, 0.231316725978648, 0.204626334519572, 0.177935943060498, 0.173487544483985, 0.169039145907473, 0.133451957295374, 0.115658362989324, 0.0889679715302485, 0.0711743772241986, 0.0444839857651238, 0.0177935943060490, 0.0355871886120989, 0.0177935943060490, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00889679715302449, 0, 0.0177935943060490, 0.0177935943060490, 0.0266903914590744, 0.0355871886120989, 0.0622775800711741, 0.0622775800711741, 0.0889679715302485, 0.0889679715302485, 0.0978647686832739, 0.106761565836298, 0.120106761565836, 0.133451957295374, 0.133451957295374, 0.151245551601423, 0.160142348754448, 0.169039145907473, 0.169039145907473, 0.195729537366548, 0.195729537366548, 0.204626334519572, 0.204626334519572, 0.231316725978648, 0.222419928825622, 0.231316725978648, 0.240213523131672, 0.240213523131672, 0.249110320284697, 0.266903914590747, 0.258007117437722, 0.266903914590747, 0.275800711743772, 0.275800711743772, 0.275800711743772, 0.293594306049822, 0.293594306049822, 0.293594306049822, 0.284697508896797, 0.302491103202846, 0.293594306049822, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.315836298932384, 0.320284697508896, 0.329181494661921, 0.338078291814946, 0.329181494661921, 0.338078291814946, 0.346975088967971, 0.346975088967971, 0.346975088967971, 0.346975088967971, 0.364768683274021, 0.355871886120996, 0.355871886120996, 0.373665480427046, 0.382562277580071, 0.382562277580071, 0.382562277580071, 0.382562277580071, 0.382562277580071, 0.382562277580071, 0.391459074733096, 0.391459074733096, 0.391459074733096, 0.382562277580071, 0.382562277580071, 0.382562277580071, 0.382562277580071, 0.382562277580071, 0.382562277580071, 0.355871886120996, 0.364768683274021, 0.346975088967971, 0.346975088967971, 0.346975088967971, 0.338078291814946, 0.333629893238434, 0.329181494661921, 0.329181494661921, 0.320284697508896, 0.311387900355872, 0.302491103202846, 0.302491103202846, 0.284697508896797, 0.275800711743772, 0.275800711743772, 0.266903914590747, 0.240213523131672, 0.240213523131672, 0.231316725978648, 0.231316725978648, 0.213523131672598, 0.204626334519572, 0.204626334519572, 0.195729537366548, 0.186832740213522, 0.186832740213522, 0.177935943060498, 0.169039145907473, 0.169039145907473, 0.169039145907473, 0.151245551601423, 0.160142348754448, 0.133451957295374, 0.133451957295374, 0.133451957295374, 0.133451957295374, 0.106761565836298, 0.106761565836298, 0.115658362989324, 0.0978647686832739, 0.0978647686832739, 0.0978647686832739, 0.0978647686832739, 0.0800711743772240, 0.0889679715302485, 0.0711743772241986, 0.0711743772241986, 0.0622775800711741, 0.0622775800711741, 0.0622775800711741, 0.0444839857651242, 0.0444839857651242, 0.0533807829181487, 0.0444839857651242, 0.0266903914590744, 0.0266903914590744, 0.0266903914590744, 0.0266903914590744, 0.0266903914590744, 0.00889679715302449, 0.0177935943060490, 0.0177935943060490, 0.0177935943060490, 0.0177935943060490, 0.00889679715302449, 0.00444839857651180, 0.00444839857651180, 0.00444839857651180, 0.00444839857651180, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0237247924080659, 0.0711743772241986, 0.106761565836298, 0.160142348754448, 0.219454329774614, 0.270462633451957, 0.326215895610913, 0.377224199288255, 0.444839857651245, 0.500762582613116, 0.584646670055922, 0.631672597864768, 0.676156583629893, 0.738434163701068, 0.800711743772242, 0.820284697508896, 0.839857651245551, 0.913404507710557, 0.946619217081850, 1.05871886120996, 1.07651245551601, 1.13523131672598, 1.18327402135231, 1.23220640569395, 1.27224199288256, 1.30782918149466, 1.30782918149466, 1.34341637010676, 1.34341637010676, 1.37900355871886, 1.38790035587189, 1.41459074733096, 1.42348754448399, 1.41459074733096, 1.41459074733096, 1.44128113879004, 1.44128113879004, 1.43238434163701, 1.44128113879004, 1.44128113879004, 1.44128113879004, 1.44128113879004, 1.44128113879004, 1.44128113879004, 1.44128113879004, 1.45017793594306, 1.44128113879004, 1.44128113879004, 1.44128113879004, 1.44128113879004, 1.43683274021352, 1.43238434163701, 1.42348754448399, 1.42348754448399, 1.43238434163701, 1.43238434163701, 1.43238434163701, 1.41459074733096, 1.41459074733096, 1.41459074733096, 1.41459074733096, 1.41459074733096, 1.38790035587189, 1.38790035587189, 1.38790035587189, 1.37900355871886, 1.37900355871886, 1.37010676156584, 1.35231316725979, 1.37010676156584, 1.34341637010676, 1.34341637010676, 1.32562277580071, 1.32562277580071, 1.31672597864769, 1.30782918149466, 1.29893238434164, 1.29003558718861, 1.27224199288256, 1.27224199288256, 1.26334519572954, 1.26334519572954, 1.24555160142349, 1.23665480427046, 1.22775800711744, 1.21886120996441, 1.21441281138790, 1.20996441281139, 1.20106761565836, 1.19217081850534, 1.19217081850534, 1.18327402135231, 1.16548042704626, 1.15658362989324, 1.15658362989324, 1.12989323843416, 1.12989323843416, 1.12099644128114, 1.12099644128114, 1.11209964412811, 1.10320284697509, 1.08540925266904, 1.07651245551601, 1.05871886120996, 1.05871886120996, 1.04982206405694, 1.04092526690391, 1.03202846975089, 1.02313167259786, 1.01423487544484, 1.00533807829181, 1.00533807829181, 0.996441281138790, 0.978647686832740, 0.965302491103202, 0.951957295373665, 0.951957295373665, 0.934163701067615, 0.934163701067615, 0.916370106761566, 0.916370106761566, 0.907473309608541, 0.898576512455516, 0.889679715302491, 0.880782918149466, 0.880782918149466, 0.854092526690391, 0.854092526690391, 0.845195729537366, 0.836298932384342, 0.827402135231317, 0.818505338078292, 0.809608540925266, 0.800711743772242, 0.782918149466192, 0.782918149466192, 0.774021352313167, 0.765124555160142, 0.747330960854092, 0.738434163701068, 0.738434163701068, 0.729537366548042, 0.711743772241992, 0.702846975088968, 0.702846975088968, 0.693950177935943, 0.685053380782918, 0.676156583629893, 0.667259786476868, 0.649466192170818, 0.640569395017793, 0.631672597864768, 0.622775800711743, 0.622775800711743, 0.596085409252669, 0.587188612099644, 0.582740213523131, 0.578291814946619, 0.569395017793594, 0.560498220640569, 0.551601423487544, 0.533807829181495, 0.533807829181495, 0.524911032028469, 0.511565836298932, 0.498220640569395, 0.489323843416369, 0.462633451957295, 0.462633451957295, 0.453736654804270, 0.444839857651245, 0.427046263345195, 0.427046263345195, 0.418149466192171, 0;
    maracuja::Spectrum<T> BSpectrum;
    BSpectrum.set(400, 950, B);

    std::vector<maracuja::Spectrum<T> > RGB(0);
    RGB.push_back(RSpectrum);
    RGB.push_back(GSpectrum);
    RGB.push_back(BSpectrum);

    // convert to RGB and save
    typename maracuja::Channel<T,Ti>::Image imgRGB = img.convolute( RGB );
    imgRGB.save_png( (baseFilename + "-RGB.png").c_str() );
}

int main(int argc, char** argv)
{
    // RGB
    Eigen::VectorXd R(551);
    R << 0.524911032028469, 0.542704626334519, 0.542704626334519, 0.542704626334519, 0.542704626334519, 0.542704626334519, 0.542704626334519, 0.551601423487544, 0.542704626334519, 0.542704626334519, 0.542704626334519, 0.542704626334519, 0.542704626334519, 0.533807829181495, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.533807829181495, 0.542704626334519, 0.533807829181495, 0.560498220640569, 0.560498220640569, 0.578291814946619, 0.587188612099644, 0.604982206405693, 0.622775800711743, 0.640569395017793, 0.658362989323843, 0.676156583629893, 0.685053380782918, 0.693950177935943, 0.702846975088968, 0.711743772241992, 0.738434163701068, 0.738434163701068, 0.756227758007117, 0.756227758007117, 0.765124555160142, 0.765124555160142, 0.756227758007117, 0.756227758007117, 0.756227758007117, 0.742882562277579, 0.729537366548042, 0.711743772241992, 0.693950177935943, 0.658362989323843, 0.622775800711743, 0.604982206405693, 0.569395017793594, 0.533807829181495, 0.498220640569395, 0.462633451957295, 0.404804270462633, 0.404804270462633, 0.346975088967971, 0.311387900355872, 0.275800711743772, 0.240213523131672, 0.204626334519572, 0.177935943060498, 0.142348754448398, 0.115658362989324, 0.0800711743772240, 0.0622775800711741, 0.0266903914590744, 0.0177935943060494, 0.00889679715302449, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0978647686832739, 0.142348754448398, 0.213523131672598, 0.293594306049822, 0.382562277580071, 0.480427046263345, 0.603005140371688, 0.676156583629893, 0.782918149466192, 0.871886120996441, 0.968762356662713, 1.05871886120996, 1.16548042704626, 1.20996441281139, 1.30782918149466, 1.40569395017794, 1.51245551601423, 1.61032028469751, 1.71708185053381, 1.79715302491103, 1.89679715302491, 1.95507117437722, 2.03736654804270, 2.08185053380783, 2.15302491103203, 2.15302491103203, 2.22419928825623, 2.24199288256228, 2.25978647686833, 2.31316725978648, 2.34875444839858, 2.39323843416370, 2.41992882562278, 2.45551601423488, 2.48220640569395, 2.50889679715302, 2.54448398576512, 2.57413997627521, 2.59786476868327, 2.63345195729537, 2.65124555160142, 2.68683274021352, 2.70462633451957, 2.71352313167260, 2.73131672597865, 2.74911032028470, 2.76690391459075, 2.77580071174377, 2.79359430604982, 2.80249110320285, 2.82028469750890, 2.82028469750890, 2.82918149466192, 2.83807829181495, 2.82918149466192, 2.82918149466192, 2.82918149466192, 2.82028469750890, 2.82028469750890, 2.82028469750890, 2.82028469750890, 2.80249110320285, 2.80249110320285, 2.79804270462633, 2.79359430604982, 2.78469750889680, 2.78469750889680, 2.77580071174377, 2.76690391459075, 2.76690391459075, 2.74911032028470, 2.74911032028470, 2.74911032028470, 2.74021352313167, 2.73131672597865, 2.73131672597865, 2.73131672597865, 2.73131672597865, 2.73131672597865, 2.72241992882562, 2.71352313167260, 2.71352313167260, 2.71352313167260, 2.71352313167260, 2.71352313167260, 2.69572953736655, 2.69572953736655, 2.69572953736655, 2.69572953736655, 2.69572953736655, 2.67793594306050, 2.67793594306050, 2.67793594306050, 2.67793594306050, 2.66014234875445, 2.66014234875445, 2.66014234875445, 2.66014234875445, 2.65569395017794, 2.65124555160142, 2.64234875444840, 2.64234875444840, 2.63345195729537, 2.62455516014235, 2.62455516014235, 2.60676156583630, 2.60676156583630, 2.60676156583630, 2.58896797153025, 2.58896797153025, 2.58896797153025, 2.57117437722420, 2.57117437722420, 2.57117437722420, 2.56227758007117, 2.55338078291815, 2.55338078291815, 2.55338078291815, 2.53558718861210, 2.53558718861210, 2.52669039145907, 2.51779359430605, 2.51779359430605, 2.50889679715302, 2.50000000000000, 2.50000000000000, 2.49110320284698, 2.48220640569395, 2.48220640569395, 2.47330960854093, 2.46441281138790, 2.46441281138790, 2.45551601423488, 2.45106761565836, 2.44661921708185, 2.44661921708185, 2.42882562277580, 2.42882562277580, 2.42882562277580, 2.41992882562278, 2.41103202846975, 2.41103202846975, 2.41103202846975, 2.39323843416370, 2.39323843416370, 2.38434163701068, 2.37544483985765, 2.37544483985765, 2.36654804270463, 2.35765124555160, 2.35765124555160, 2.35765124555160, 2.35765124555160, 2.35765124555160, 2.34875444839858, 2.34875444839858, 2.34875444839858, 2.34875444839858, 2.34875444839858, 2.34875444839858, 2.33985765124555, 2.33985765124555, 2.33985765124555, 2.33985765124555, 2.33985765124555, 2.33985765124555, 2.33985765124555, 2.33985765124555, 2.33985765124555, 2.33985765124555, 2.33985765124555, 2.33985765124555, 2.33985765124555, 2.33985765124555, 2.33096085409253, 2.33096085409253, 2.32206405693950, 2.32206405693950, 2.32206405693950, 2.32206405693950, 2.32206405693950, 2.32206405693950, 2.32206405693950, 2.32206405693950, 2.32206405693950, 2.31316725978648, 2.30427046263345, 2.30427046263345, 2.30427046263345, 2.30427046263345, 2.30427046263345, 2.30427046263345, 2.30427046263345, 2.28647686832740, 2.28647686832740, 2.28647686832740, 2.28647686832740, 2.28647686832740, 2.27758007117438, 2.26868327402135, 2.26868327402135, 2.26868327402135, 2.26868327402135, 2.25088967971530, 2.25088967971530, 2.25088967971530, 2.25088967971530, 2.24199288256228, 2.23309608540925, 2.23309608540925, 2.23309608540925, 2.23309608540925, 2.21530249110320, 2.21530249110320, 2.20640569395018, 2.19750889679715, 2.19750889679715, 2.19750889679715, 2.17971530249110, 2.17971530249110, 2.16192170818505, 2.16192170818505, 2.16192170818505, 2.16192170818505, 2.14412811387900, 2.14412811387900, 2.14412811387900, 2.13523131672598, 2.12633451957295, 2.12633451957295, 2.12633451957295, 2.12633451957295, 2.10854092526690, 2.10854092526690, 2.10854092526690, 2.09074733096085, 2.09074733096085, 2.09074733096085, 2.09074733096085, 2.08185053380783, 2.07295373665480, 2.07295373665480, 2.07295373665480, 2.05516014234875, 2.05516014234875, 2.05516014234875, 2.03736654804270, 2.03736654804270, 2.03736654804270, 2.02846975088968, 2.01957295373665, 2.01957295373665, 2.00177935943061, 2.00177935943061, 1.99288256227758, 1.99288256227758, 1.99288256227758, 1.95729537366548, 1.95284697508897, 1.94839857651246, 1.94839857651246, 1.93950177935943, 1.93060498220641, 1.91281138790036, 1.91281138790036, 1.89501779359431, 1.88612099644128, 1.87722419928826, 1.86832740213523, 1.85943060498221, 1.84163701067616, 1.84163701067616, 1.82384341637011, 1.80604982206406, 1.80604982206406, 1.80604982206406, 1.78825622775801, 1.77935943060498, 1.77046263345196, 1.75266903914591, 1.74377224199288, 1.73487544483986, 1.71708185053381, 1.70818505338078, 1.69928825622776, 1.68149466192171, 1.67259786476868, 1.66370106761566, 1.64590747330961, 1.63701067615658, 1.62811387900356, 1.61032028469751, 1.60142348754448, 1.59252669039146, 1.57473309608541, 1.56583629893238, 1.55693950177936, 1.54804270462633, 1.53469750889680, 1.52135231316726, 1.50355871886121, 1.49466192170818, 1.48576512455516, 1.48576512455516, 1.45907473309609, 1.45017793594306, 1.43238434163701, 1.42348754448399, 1.41459074733096, 1.39679715302491, 1.39234875444840, 1.38790035587189, 1.37900355871886, 1.36120996441281, 1.35231316725979, 1.34341637010676, 1.32562277580071, 1.30782918149466, 1.30782918149466, 1.29003558718861, 1.29003558718861, 1.27224199288256, 1.26334519572954, 1.23665480427046, 1.23665480427046, 1.21886120996441, 1.20996441281139, 1.20106761565836, 1.18327402135231, 1.17437722419929, 1.16548042704626, 1.14768683274021, 1.13879003558719, 1.12989323843416, 1.11209964412811, 1.10320284697509, 1.09430604982206, 1.08540925266904, 1.07651245551601, 1.05871886120996, 1.05871886120996, 1.04092526690391, 1.04092526690391, 1.02313167259786, 1.02313167259786, 1.01423487544484, 1.00533807829181, 1.00533807829181, 0.996441281138790, 0.996441281138790, 0.960854092526690, 0.951957295373665, 0.951957295373665, 0.934163701067615, 0.916370106761566, 0.916370106761566, 0.907473309608540, 0.898576512455516, 0.880782918149466, 0.880782918149466, 0.862989323843416, 0.854092526690391, 0.818505338078292, 0.845195729537366, 0.827402135231316, 0.827402135231316, 0.809608540925266, 0.809608540925266, 0.809608540925266, 0.791814946619216, 0.791814946619216, 0.774021352313167, 0.774021352313167, 0.774021352313167, 0.756227758007117, 0.756227758007117, 0.756227758007117, 0.738434163701068, 0.738434163701068, 0.738434163701068, 0.738434163701068, 0.738434163701068, 0.738434163701068, 0.720640569395018, 0.720640569395018, 0.720640569395018, 0.711743772241992, 0.702846975088968, 0.702846975088968, 0.702846975088968, 0.702846975088968, 0.685053380782918, 0.685053380782918, 0.685053380782918, 0.667259786476868, 0.667259786476868, 0.667259786476868, 0.667259786476868, 0;
    maracuja::Spectrum RSpectrum;
    RSpectrum.setValues(400, 950, R);
    assert( R.isApprox( RSpectrum.getData() ) );

    Eigen::VectorXd G(551);
    G << 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0177935943060490, 0.0355871886120989, 0.0800711743772240, 0.106761565836298, 0.142348754448398, 0.177935943060498, 0.222419928825622, 0.258007117437722, 0.302491103202846, 0.346975088967971, 0.409252669039145, 0.427046263345195, 0.489323843416369, 0.524911032028469, 0.578291814946619, 0.596085409252669, 0.667259786476868, 0.702846975088968, 0.774021352313167, 0.809608540925266, 0.889679715302491, 0.925266903914590, 1.01067615658363, 1.03024911032028, 1.04982206405694, 1.12989323843416, 1.18327402135231, 1.26334519572954, 1.32562277580071, 1.39679715302491, 1.46797153024911, 1.55693950177936, 1.61921708185053, 1.71708185053381, 1.76156583629893, 1.87722419928826, 1.92425012709710, 2.04626334519573, 2.10854092526690, 2.20640569395018, 2.25978647686833, 2.36654804270463, 2.42882562277580, 2.50000000000000, 2.53558718861210, 2.66903914590747, 2.66192170818505, 2.74911032028470, 2.79359430604982, 2.84697508896797, 2.89145907473310, 2.92704626334520, 2.94483985765125, 2.97153024911032, 2.98932384341637, 2.99822064056939, 3.01601423487544, 3.03380782918149, 3.03380782918149, 3.03380782918149, 3.05160142348754, 3.06939501779359, 3.08718861209964, 3.08718861209964, 3.10498220640569, 3.10498220640569, 3.10498220640569, 3.12277580071174, 3.12277580071174, 3.12277580071174, 3.14056939501779, 3.14056939501779, 3.15836298932384, 3.15836298932384, 3.16725978647687, 3.17615658362989, 3.19395017793594, 3.19395017793594, 3.19395017793594, 3.21174377224199, 3.22953736654804, 3.22953736654804, 3.22953736654804, 3.22953736654804, 3.22953736654804, 3.22953736654804, 3.23843416370107, 3.23843416370107, 3.24733096085409, 3.24733096085409, 3.24733096085409, 3.23843416370107, 3.22953736654804, 3.22953736654804, 3.22953736654804, 3.22953736654804, 3.22953736654804, 3.19395017793594, 3.18505338078292, 3.16281138790036, 3.14056939501779, 3.11387900355872, 3.09608540925267, 3.06939501779359, 3.03380782918149, 3.00711743772242, 2.97153024911032, 2.92704626334520, 2.90035587188612, 2.85587188612100, 2.82028469750890, 2.78469750889680, 2.74911032028470, 2.69572953736655, 2.66903914590747, 2.61565836298932, 2.58896797153025, 2.54448398576512, 2.50889679715302, 2.45551601423488, 2.41992882562278, 2.35765124555160, 2.33096085409253, 2.26868327402135, 2.23309608540925, 2.16192170818505, 2.13523131672598, 2.07295373665480, 2.05516014234875, 2.03736654804270, 1.96441281138790, 1.92170818505338, 1.85943060498221, 1.80604982206406, 1.73487544483986, 1.69928825622776, 1.62811387900356, 1.59252669039146, 1.52135231316726, 1.48576512455516, 1.41459074733096, 1.37900355871886, 1.30782918149466, 1.26334519572954, 1.20106761565836, 1.15658362989324, 1.10320284697509, 1.06761565836299, 1.01423487544484, 0.956405693950178, 0.916370106761566, 0.871886120996441, 0.827402135231316, 0.791814946619216, 0.729537366548042, 0.693950177935943, 0.649466192170818, 0.622775800711743, 0.578291814946619, 0.533807829181495, 0.489323843416369, 0.453736654804270, 0.400355871886121, 0.373665480427046, 0.355871886120996, 0.338078291814946, 0.302491103202846, 0.284697508896797, 0.258007117437722, 0.240213523131672, 0.213523131672598, 0.142348754448398, 0.133451957295374, 0.106761565836298, 0.0889679715302485, 0.0622775800711741, 0.0533807829181487, 0.0355871886120989, 0.0266903914590744, 0.0133451957295367, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00889679715302449, 0.00889679715302449, 0.00889679715302449, 0.0177935943060490, 0.0266903914590744, 0.0266903914590744, 0.0266903914590744, 0.0355871886120989, 0.0444839857651242, 0.0444839857651242, 0.0444839857651242, 0.0622775800711741, 0.0622775800711741, 0.0622775800711741, 0.0800711743772240, 0.0978647686832739, 0.0978647686832739, 0.115658362989324, 0.115658362989324, 0.133451957295374, 0.133451957295374, 0.142348754448398, 0.151245551601423, 0.169039145907473, 0.177935943060498, 0.186832740213522, 0.204626334519572, 0.204626334519572, 0.213523131672598, 0.222419928825622, 0.240213523131672, 0.231316725978648, 0.249110320284697, 0.266903914590747, 0.266903914590747, 0.275800711743772, 0.284697508896797, 0.284697508896797, 0.293594306049822, 0.293594306049822, 0.293594306049822, 0.293594306049822, 0.302491103202846, 0.302491103202846, 0.302491103202846, 0.302491103202846, 0.302491103202846, 0.302491103202846, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.320284697508896, 0.329181494661921, 0.329181494661921, 0.346975088967971, 0.346975088967971, 0.346975088967971, 0.346975088967971, 0.346975088967971, 0.364768683274021, 0.364768683274021, 0.364768683274021, 0.373665480427046, 0.382562277580071, 0.382562277580071, 0.382562277580071, 0.400355871886121, 0.400355871886121, 0.400355871886121, 0.418149466192171, 0.418149466192171, 0.418149466192171, 0.435943060498221, 0.435943060498221, 0.444839857651245, 0.453736654804270, 0.453736654804270, 0.471530249110320, 0.489323843416369, 0.489323843416369, 0.489323843416369, 0.489323843416369, 0.507117437722419, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.542704626334519, 0.560498220640569, 0.560498220640569, 0.560498220640569, 0.578291814946619, 0.587188612099644, 0.596085409252669, 0.596085409252669, 0.613879003558719, 0.613879003558719, 0.622775800711743, 0.631672597864768, 0.631672597864768, 0.640569395017793, 0.649466192170818, 0.649466192170818, 0.667259786476868, 0.667259786476868, 0.667259786476868, 0.667259786476868, 0.685053380782918, 0.685053380782918, 0.693950177935943, 0.702846975088968, 0.702846975088968, 0.702846975088968, 0.676156583629893, 0.693950177935943, 0.711743772241992, 0.716192170818505, 0.720640569395018, 0.720640569395018, 0.729537366548042, 0.738434163701068, 0.738434163701068, 0.738434163701068, 0.738434163701068, 0.729537366548042, 0.729537366548042, 0.729537366548042, 0.729537366548042, 0.720640569395018, 0.720640569395018, 0.720640569395018, 0.711743772241992, 0.702846975088968, 0.702846975088968, 0.702846975088968, 0.702846975088968, 0.702846975088968, 0.702846975088968, 0.693950177935943, 0.685053380782918, 0.685053380782918, 0.667259786476868, 0.667259786476868, 0.667259786476868, 0.667259786476868, 0.649466192170818, 0.649466192170818, 0.631672597864768, 0.631672597864768, 0.631672597864768, 0.631672597864768, 0.622775800711743, 0.613879003558719, 0.613879003558719, 0.613879003558719, 0.596085409252669, 0.596085409252669, 0.596085409252669, 0.596085409252669, 0.587188612099644, 0.578291814946619, 0.578291814946619, 0.578291814946619, 0.560498220640569, 0.560498220640569, 0.560498220640569, 0.560498220640569, 0.560498220640569, 0.560498220640569, 0.551601423487544, 0.542704626334519, 0.542704626334519, 0.542704626334519, 0.542704626334519, 0.533807829181495, 0.529359430604982, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.524911032028469, 0.516014234875445, 0.507117437722419, 0.507117437722419, 0.507117437722419, 0.507117437722419, 0.489323843416369, 0.489323843416369, 0.489323843416369, 0.489323843416369, 0.489323843416369, 0.489323843416369, 0.489323843416369, 0.480427046263345, 0.471530249110320, 0.462633451957295, 0.453736654804270, 0.453736654804270, 0.453736654804270, 0.453736654804270, 0.444839857651245, 0.435943060498221, 0.435943060498221, 0.435943060498221, 0.427046263345195, 0.418149466192171, 0.418149466192171, 0.418149466192171, 0.400355871886121, 0.400355871886121, 0.382562277580071, 0.382562277580071, 0.382562277580071, 0.382562277580071, 0.378113879003558, 0.373665480427046, 0.364768683274021, 0.364768683274021, 0.355871886120996, 0.346975088967971, 0.346975088967971, 0.346975088967971, 0.338078291814946, 0.329181494661921, 0.329181494661921, 0.329181494661921, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.293594306049822, 0.293594306049822, 0.293594306049822, 0.293594306049822, 0.275800711743772, 0.275800711743772, 0.275800711743772, 0.266903914590747, 0.258007117437722, 0.258007117437722, 0.258007117437722, 0.249110320284697, 0.240213523131672, 0.240213523131672, 0.240213523131672, 0.240213523131672, 0.240213523131672, 0.240213523131672, 0.231316725978647, 0.222419928825622, 0.222419928825622, 0.222419928825622, 0.222419928825622, 0.213523131672598, 0.213523131672598, 0.204626334519572, 0.204626334519572, 0.204626334519572, 0.204626334519572, 0.204626334519572, 0.186832740213522, 0.186832740213522, 0.186832740213522, 0.186832740213522, 0.186832740213522, 0.177935943060498, 0;
    maracuja::Spectrum GSpectrum;
    GSpectrum.setValues(400, 950, G);
    assert( G.isApprox( GSpectrum.getData() ) );

    Eigen::VectorXd B(551);
    B << 2.57117437722420, 2.67793594306050, 2.74021352313167, 2.77876631079478, 2.81731909845789, 2.86832740213523, 2.91814946619217, 2.97597864768683, 3.03380782918149, 3.08185053380783, 3.14946619217082, 3.18505338078292, 3.24436536180308, 3.29181494661922, 3.34163701067616, 3.37633451957295, 3.42526690391459, 3.44750889679715, 3.50533807829182, 3.53202846975089, 3.59074733096085, 3.62989323843416, 3.67437722419929, 3.70699881376038, 3.76868327402135, 3.80338078291815, 3.87010676156584, 3.90569395017794, 3.97508896797153, 4.01245551601424, 4.07473309608541, 4.12811387900356, 4.18446026097272, 4.24673784104389, 4.30604982206406, 4.35349940688019, 4.43060498220641, 4.46975088967972, 4.50578291814947, 4.54181494661922, 4.57651245551601, 4.63523131672598, 4.67081850533808, 4.71530249110320, 4.75088967971530, 4.77758007117438, 4.80427046263345, 4.83985765124555, 4.83096085409253, 4.83985765124555, 4.83985765124555, 4.83985765124555, 4.81316725978648, 4.79537366548043, 4.76868327402135, 4.71886120996441, 4.69395017793594, 4.63523131672598, 4.58007117437722, 4.52846975088968, 4.47508896797153, 4.41281138790036, 4.36832740213523, 4.30308422301305, 4.27935943060498, 4.19928825622776, 4.16014234875445, 4.08362989323843, 4.02728351126928, 3.93950177935943, 3.89679715302491, 3.83451957295374, 3.77817319098458, 3.71293001186240, 3.68742586002373, 3.66192170818505, 3.60320284697509, 3.55516014234875, 3.49644128113879, 3.44839857651246, 3.38967971530249, 3.34074733096085, 3.29181494661922, 3.24733096085409, 3.19395017793594, 3.15391459074733, 3.10320284697509, 3.05693950177936, 3.00711743772242, 2.96085409252669, 2.90925266903915, 2.86921708185053, 2.79715302491103, 2.75800711743772, 2.69572953736655, 2.67793594306050, 2.57117437722420, 2.55871886120996, 2.48220640569395, 2.45195729537367, 2.37010676156584, 2.33985765124555, 2.26868327402135, 2.21233689205219, 2.13523131672598, 2.07930859176411, 1.98102016607355, 1.91814946619217, 1.82680901542111, 1.81071004914421, 1.79461108286731, 1.70818505338078, 1.64590747330961, 1.55693950177936, 1.50991357397051, 1.41331977630910, 1.36756481952211, 1.28113879003559, 1.22521606507372, 1.14641586171835, 1.08540925266904, 1.01423487544484, 0.964412811387899, 0.907473309608540, 0.871886120996441, 0.804270462633451, 0.747330960854092, 0.707295373665480, 0.662811387900356, 0.622775800711743, 0.578291814946619, 0.516014234875445, 0.510083036773428, 0.462633451957295, 0.435943060498221, 0.400355871886121, 0.367734282325030, 0.338078291814946, 0.311387900355872, 0.275800711743772, 0.260972716488730, 0.231316725978648, 0.204626334519572, 0.177935943060498, 0.173487544483985, 0.169039145907473, 0.133451957295374, 0.115658362989324, 0.0889679715302485, 0.0711743772241986, 0.0444839857651238, 0.0177935943060490, 0.0355871886120989, 0.0177935943060490, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00889679715302449, 0, 0.0177935943060490, 0.0177935943060490, 0.0266903914590744, 0.0355871886120989, 0.0622775800711741, 0.0622775800711741, 0.0889679715302485, 0.0889679715302485, 0.0978647686832739, 0.106761565836298, 0.120106761565836, 0.133451957295374, 0.133451957295374, 0.151245551601423, 0.160142348754448, 0.169039145907473, 0.169039145907473, 0.195729537366548, 0.195729537366548, 0.204626334519572, 0.204626334519572, 0.231316725978648, 0.222419928825622, 0.231316725978648, 0.240213523131672, 0.240213523131672, 0.249110320284697, 0.266903914590747, 0.258007117437722, 0.266903914590747, 0.275800711743772, 0.275800711743772, 0.275800711743772, 0.293594306049822, 0.293594306049822, 0.293594306049822, 0.284697508896797, 0.302491103202846, 0.293594306049822, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.311387900355872, 0.315836298932384, 0.320284697508896, 0.329181494661921, 0.338078291814946, 0.329181494661921, 0.338078291814946, 0.346975088967971, 0.346975088967971, 0.346975088967971, 0.346975088967971, 0.364768683274021, 0.355871886120996, 0.355871886120996, 0.373665480427046, 0.382562277580071, 0.382562277580071, 0.382562277580071, 0.382562277580071, 0.382562277580071, 0.382562277580071, 0.391459074733096, 0.391459074733096, 0.391459074733096, 0.382562277580071, 0.382562277580071, 0.382562277580071, 0.382562277580071, 0.382562277580071, 0.382562277580071, 0.355871886120996, 0.364768683274021, 0.346975088967971, 0.346975088967971, 0.346975088967971, 0.338078291814946, 0.333629893238434, 0.329181494661921, 0.329181494661921, 0.320284697508896, 0.311387900355872, 0.302491103202846, 0.302491103202846, 0.284697508896797, 0.275800711743772, 0.275800711743772, 0.266903914590747, 0.240213523131672, 0.240213523131672, 0.231316725978648, 0.231316725978648, 0.213523131672598, 0.204626334519572, 0.204626334519572, 0.195729537366548, 0.186832740213522, 0.186832740213522, 0.177935943060498, 0.169039145907473, 0.169039145907473, 0.169039145907473, 0.151245551601423, 0.160142348754448, 0.133451957295374, 0.133451957295374, 0.133451957295374, 0.133451957295374, 0.106761565836298, 0.106761565836298, 0.115658362989324, 0.0978647686832739, 0.0978647686832739, 0.0978647686832739, 0.0978647686832739, 0.0800711743772240, 0.0889679715302485, 0.0711743772241986, 0.0711743772241986, 0.0622775800711741, 0.0622775800711741, 0.0622775800711741, 0.0444839857651242, 0.0444839857651242, 0.0533807829181487, 0.0444839857651242, 0.0266903914590744, 0.0266903914590744, 0.0266903914590744, 0.0266903914590744, 0.0266903914590744, 0.00889679715302449, 0.0177935943060490, 0.0177935943060490, 0.0177935943060490, 0.0177935943060490, 0.00889679715302449, 0.00444839857651180, 0.00444839857651180, 0.00444839857651180, 0.00444839857651180, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0237247924080659, 0.0711743772241986, 0.106761565836298, 0.160142348754448, 0.219454329774614, 0.270462633451957, 0.326215895610913, 0.377224199288255, 0.444839857651245, 0.500762582613116, 0.584646670055922, 0.631672597864768, 0.676156583629893, 0.738434163701068, 0.800711743772242, 0.820284697508896, 0.839857651245551, 0.913404507710557, 0.946619217081850, 1.05871886120996, 1.07651245551601, 1.13523131672598, 1.18327402135231, 1.23220640569395, 1.27224199288256, 1.30782918149466, 1.30782918149466, 1.34341637010676, 1.34341637010676, 1.37900355871886, 1.38790035587189, 1.41459074733096, 1.42348754448399, 1.41459074733096, 1.41459074733096, 1.44128113879004, 1.44128113879004, 1.43238434163701, 1.44128113879004, 1.44128113879004, 1.44128113879004, 1.44128113879004, 1.44128113879004, 1.44128113879004, 1.44128113879004, 1.45017793594306, 1.44128113879004, 1.44128113879004, 1.44128113879004, 1.44128113879004, 1.43683274021352, 1.43238434163701, 1.42348754448399, 1.42348754448399, 1.43238434163701, 1.43238434163701, 1.43238434163701, 1.41459074733096, 1.41459074733096, 1.41459074733096, 1.41459074733096, 1.41459074733096, 1.38790035587189, 1.38790035587189, 1.38790035587189, 1.37900355871886, 1.37900355871886, 1.37010676156584, 1.35231316725979, 1.37010676156584, 1.34341637010676, 1.34341637010676, 1.32562277580071, 1.32562277580071, 1.31672597864769, 1.30782918149466, 1.29893238434164, 1.29003558718861, 1.27224199288256, 1.27224199288256, 1.26334519572954, 1.26334519572954, 1.24555160142349, 1.23665480427046, 1.22775800711744, 1.21886120996441, 1.21441281138790, 1.20996441281139, 1.20106761565836, 1.19217081850534, 1.19217081850534, 1.18327402135231, 1.16548042704626, 1.15658362989324, 1.15658362989324, 1.12989323843416, 1.12989323843416, 1.12099644128114, 1.12099644128114, 1.11209964412811, 1.10320284697509, 1.08540925266904, 1.07651245551601, 1.05871886120996, 1.05871886120996, 1.04982206405694, 1.04092526690391, 1.03202846975089, 1.02313167259786, 1.01423487544484, 1.00533807829181, 1.00533807829181, 0.996441281138790, 0.978647686832740, 0.965302491103202, 0.951957295373665, 0.951957295373665, 0.934163701067615, 0.934163701067615, 0.916370106761566, 0.916370106761566, 0.907473309608541, 0.898576512455516, 0.889679715302491, 0.880782918149466, 0.880782918149466, 0.854092526690391, 0.854092526690391, 0.845195729537366, 0.836298932384342, 0.827402135231317, 0.818505338078292, 0.809608540925266, 0.800711743772242, 0.782918149466192, 0.782918149466192, 0.774021352313167, 0.765124555160142, 0.747330960854092, 0.738434163701068, 0.738434163701068, 0.729537366548042, 0.711743772241992, 0.702846975088968, 0.702846975088968, 0.693950177935943, 0.685053380782918, 0.676156583629893, 0.667259786476868, 0.649466192170818, 0.640569395017793, 0.631672597864768, 0.622775800711743, 0.622775800711743, 0.596085409252669, 0.587188612099644, 0.582740213523131, 0.578291814946619, 0.569395017793594, 0.560498220640569, 0.551601423487544, 0.533807829181495, 0.533807829181495, 0.524911032028469, 0.511565836298932, 0.498220640569395, 0.489323843416369, 0.462633451957295, 0.462633451957295, 0.453736654804270, 0.444839857651245, 0.427046263345195, 0.427046263345195, 0.418149466192171, 0;
    maracuja::Spectrum BSpectrum;
    BSpectrum.setValues(400, 950, B);
    assert( B.isApprox( BSpectrum.getData() ) );

    std::vector<maracuja::Spectrum> RGB(0);
    RGB.push_back(RSpectrum);
    RGB.push_back(GSpectrum);
    RGB.push_back(BSpectrum);
    //assert( B.isApprox( RGB(2).getData() ) );

    // Sensitivity
    Eigen::VectorXd Sensitivity(551);
    Sensitivity << 0, 0, 0, 0.248571428571429, 0.251278195488722, 0.254436090225564, 0.257593984962406, 0.260751879699248, 0.263909774436090, 0.267518796992481, 0.270225563909775, 0.273834586466166, 0.277443609022556, 0.280150375939850, 0.283759398496241, 0.286466165413534, 0.290075187969925, 0.294702966206726, 0.300128893662728, 0.303782533256218, 0.306766917293233, 0.309924812030075, 0.313082706766917, 0.316240601503759, 0.319849624060150, 0.322556390977444, 0.326165413533835, 0.329323308270677, 0.332481203007519, 0.336090225563910, 0.338796992481203, 0.341954887218045, 0.345503759398496, 0.348270676691729, 0.352330827067669, 0.354586466165414, 0.357808807733620, 0.360902255639098, 0.363609022556391, 0.366766917293233, 0.369022556390978, 0.372631578947369, 0.375789473684211, 0.378947368421053, 0.381654135338346, 0.383909774436090, 0.386616541353384, 0.389323308270677, 0.392030075187970, 0.393383458646617, 0.397890635680109, 0.403578947368421, 0.405112781954887, 0.406466165413534, 0.409624060150376, 0.411879699248120, 0.414586466165414, 0.416842105263158, 0.418646616541354, 0.421804511278196, 0.423157894736842, 0.426315789473684, 0.428120300751880, 0.430375939849624, 0.432631578947369, 0.434887218045113, 0.437593984962406, 0.438947368421053, 0.441203007518797, 0.443458646616541, 0.445714285714286, 0.447969924812030, 0.449323308270677, 0.451578947368421, 0.453834586466166, 0.455639097744361, 0.456992481203008, 0.459248120300752, 0.461503759398496, 0.463308270676692, 0.465112781954887, 0.467368421052632, 0.469624060150376, 0.471654135338346, 0.474586466165414, 0.476390977443609, 0.477744360902256, 0.479548872180451, 0.481353383458647, 0.483157894736842, 0.484511278195489, 0.485864661654135, 0.487669172932331, 0.489022556390978, 0.490827067669173, 0.492180451127820, 0.493533834586466, 0.494436090225564, 0.495338345864662, 0.496992481203008, 0.499142857142857, 0.499142857142857, 0.501293233082707, 0.503007518796993, 0.503458646616541, 0.503458646616541, 0.504360902255639, 0.505263157894737, 0.505263157894737, 0.505714285714286, 0.506165413533835, 0.506616541353384, 0.506165413533835, 0.506165413533835, 0.506165413533835, 0.506165413533835, 0.506165413533835, 0.505488721804511, 0.505263157894737, 0.504812030075188, 0.504360902255639, 0.503458646616541, 0.503458646616541, 0.503007518796993, 0.502556390977444, 0.502105263157895, 0.501293233082707, 0.500751879699248, 0.500030075187970, 0.500030075187970, 0.499398496240602, 0.498766917293233, 0.498045112781955, 0.498045112781955, 0.498045112781955, 0.497503759398496, 0.497503759398496, 0.497503759398496, 0.496240601503760, 0.496240601503760, 0.495789473684211, 0.495789473684211, 0.495338345864662, 0.494887218045113, 0.494436090225564, 0.493533834586466, 0.493082706766917, 0.492180451127820, 0.491729323308271, 0.490827067669173, 0.489473684210526, 0.488571428571429, 0.487669172932331, 0.486766917293233, 0.485413533834587, 0.484060150375940, 0.483157894736842, 0.482255639097744, 0.481353383458647, 0.480451127819549, 0.479548872180451, 0.478646616541353, 0.477293233082707, 0.476842105263158, 0.475939849624060, 0.474586466165414, 0.473233082706767, 0.472330827067669, 0.471428571428572, 0.470526315789474, 0.469624060150376, 0.468721804511278, 0.467368421052632, 0.466015037593985, 0.465112781954887, 0.464210526315790, 0.462857142857143, 0.462406015037594, 0.461052631578947, 0.459699248120301, 0.458796992481203, 0.457894736842105, 0.456992481203008, 0.455187969924812, 0.453834586466166, 0.452481203007519, 0.451578947368421, 0.450225563909775, 0.449774436090226, 0.448421052631579, 0.447067669172932, 0.446616541353384, 0.445263157894737, 0.444360902255639, 0.443007518796993, 0.442556390977444, 0.441203007518797, 0.439849624060150, 0.438947368421053, 0.438045112781955, 0.436691729323308, 0.436691729323308, 0.435338345864662, 0.434436090225564, 0.433533834586466, 0.432631578947369, 0.431729323308271, 0.430827067669173, 0.429924812030075, 0.429022556390978, 0.427669172932331, 0.426766917293233, 0.425864661654135, 0.424962406015038, 0.424060150375940, 0.423609022556391, 0.422706766917293, 0.421353383458647, 0.420000000000000, 0.419097744360902, 0.418195488721805, 0.417293233082707, 0.416390977443609, 0.415488721804511, 0.414586466165414, 0.413684210526316, 0.412781954887218, 0.411879699248120, 0.410977443609023, 0.410075187969925, 0.409172932330827, 0.408270676691729, 0.407368421052632, 0.406466165413534, 0.405563909774436, 0.404661654135338, 0.403759398496241, 0.402857142857143, 0.401654135338346, 0.400451127819549, 0.399248120300752, 0.398045112781955, 0.396842105263158, 0.395187969924812, 0.394736842105263, 0.393834586466166, 0.392481203007519, 0.391578947368421, 0.390225563909775, 0.389323308270677, 0.387518796992481, 0.385263157894737, 0.384360902255639, 0.382556390977444, 0.381654135338346, 0.380300751879699, 0.378947368421053, 0.378045112781955, 0.376240601503760, 0.375338345864662, 0.373533834586466, 0.372180451127820, 0.370827067669173, 0.369473684210526, 0.367669172932331, 0.366315789473684, 0.364962406015038, 0.363609022556391, 0.361804511278196, 0.360902255639098, 0.359097744360902, 0.357744360902256, 0.355488721804511, 0.354586466165414, 0.353233082706767, 0.351428571428572, 0.349624060150376, 0.348270676691729, 0.346917293233083, 0.345112781954887, 0.343759398496241, 0.341954887218045, 0.340601503759399, 0.337894736842105, 0.335639097744361, 0.334285714285714, 0.332481203007519, 0.330676691729323, 0.329323308270677, 0.327518796992481, 0.326616541353384, 0.324360902255639, 0.322556390977444, 0.321654135338346, 0.319849624060150, 0.318045112781955, 0.316691729323308, 0.314887218045113, 0.313984962406015, 0.311729323308271, 0.309473684210526, 0.309473684210526, 0.307218045112782, 0.305413533834587, 0.304060150375940, 0.303157894736842, 0.300837808807734, 0.299097744360902, 0.296197636949517, 0.294586466165414, 0.293684210526316, 0.292330827067669, 0.290526315789474, 0.289172932330827, 0.287368421052632, 0.285112781954887, 0.283759398496241, 0.281052631578947, 0.278345864661654, 0.276541353383459, 0.274736842105263, 0.273383458646617, 0.271578947368421, 0.270225563909775, 0.268421052631579, 0.266165413533835, 0.264360902255639, 0.263007518796993, 0.261203007518797, 0.259398496240602, 0.257593984962406, 0.256691729323308, 0.254887218045113, 0.253082706766917, 0.251278195488722, 0.249924812030075, 0.247669172932331, 0.245864661654135, 0.244962406015038, 0.243157894736842, 0.241353383458647, 0.239548872180451, 0.238195488721805, 0.236390977443609, 0.235037593984962, 0.233684210526316, 0.231879699248120, 0.230526315789474, 0.229172932330827, 0.227368421052632, 0.225338345864662, 0.222857142857143, 0.221954887218045, 0.220150375939850, 0.218796992481203, 0.217443609022556, 0.216090225563910, 0.214736842105263, 0.212932330827068, 0.212030075187970, 0.210676691729323, 0.208872180451128, 0.207969924812030, 0.207067669172932, 0.205263157894737, 0.203909774436090, 0.203458646616541, 0.201428571428571, 0.200413533834587, 0.198882921589689, 0.196820622986037, 0.195789473684211, 0.194887218045113, 0.194436090225564, 0.192631578947368, 0.191278195488722, 0.190375939849624, 0.189022556390977, 0.187218045112782, 0.186766917293233, 0.185413533834586, 0.183609022556391, 0.183609022556391, 0.181353383458647, 0.179548872180451, 0.178646616541353, 0.177293233082707, 0.176390977443609, 0.175037593984962, 0.174135338345865, 0.172781954887218, 0.171879699248120, 0.170977443609023, 0.170075187969925, 0.168721804511278, 0.167368421052632, 0.166917293233083, 0.165563909774436, 0.164210526315790, 0.163759398496241, 0.162857142857143, 0.161729323308271, 0.160601503759399, 0.159248120300752, 0.158796992481203, 0.157443609022556, 0.156541353383459, 0.155639097744361, 0.155187969924812, 0.154285714285714, 0.153383458646617, 0.152481203007519, 0.151578947368421, 0.151127819548872, 0.150225563909774, 0.149323308270677, 0.148421052631579, 0.147293233082707, 0.146165413533835, 0.145263157894737, 0.144812030075188, 0.143458646616541, 0.143458646616541, 0.142556390977444, 0.141654135338346, 0.141654135338346, 0.139849624060150, 0.139849624060150, 0.138947368421053, 0.138496240601504, 0.137593984962406, 0.137142857142857, 0.136240601503759, 0.135338345864662, 0.134887218045113, 0.133533834586466, 0.133533834586466, 0.132631578947368, 0.131729323308271, 0.131278195488722, 0.129924812030075, 0.129924812030075, 0.129022556390977, 0.128120300751880, 0.127669172932331, 0.126766917293233, 0.125413533834586, 0.124962406015038, 0.124511278195489, 0.123609022556391, 0.122481203007519, 0.121353383458647, 0.120451127819549, 0.119548872180451, 0.118646616541353, 0.117744360902256, 0.116842105263158, 0.115939849624060, 0.115037593984962, 0.114135338345865, 0.113233082706767, 0.112330827067669, 0.111428571428571, 0.110526315789474, 0.109624060150376, 0.109172932330827, 0.107819548872180, 0.107368421052632, 0.106015037593985, 0.105563909774436, 0.103759398496241, 0.103308270676692, 0.103308270676692, 0.102105263157895, 0.100902255639098, 0.0996992481203007, 0.0984962406015038, 0.0965413533834587, 0.0960902255639098, 0.0956390977443610, 0.0951879699248120, 0.0942857142857143, 0.0933834586466166, 0.0920300751879700, 0.0906766917293234, 0.0897744360902256, 0.0888721804511279, 0.0879699248120301, 0.0866165413533835, 0.0866165413533835, 0.0848120300751880, 0.0843609022556391, 0.0834586466165413, 0.0830075187969925, 0.0821052631578948, 0.0812030075187971, 0.0803007518796993, 0.0798496240601504, 0.0789473684210527, 0.0780451127819549, 0.0775939849624060, 0.0766917293233083, 0.0757894736842105, 0.0753383458646617, 0.0748872180451128, 0.0739849624060150, 0.0730827067669173, 0.0726315789473685, 0.0721804511278196, 0.0712781954887218, 0.0708270676691729, 0.0703759398496241, 0.0694736842105264, 0.0690225563909774, 0.0685714285714286, 0.0676691729323309, 0.0672180451127820, 0.0663157894736843, 0.0658646616541354, 0.0649624060150377, 0.0645112781954887, 0.0640601503759398, 0.0636090225563910, 0.0631578947368421, 0.0622556390977443, 0.0613533834586466, 0.0613533834586466, 0.0604511278195489, 0.0604511278195489, 0.0595488721804511, 0.0595488721804511, 0.0586466165413534, 0.0586466165413534, 0.0577443609022557, 0.0572932330827067, 0.0568421052631579, 0.0559398496240602, 0.0554887218045113, 0.0550375939849624, 0.0550375939849624, 0.0541353383458647, 0.0541353383458647, 0.0532330827067670, 0.0527819548872180, 0.0523308270676692, 0.0518796992481203, 0.0514285714285715, 0.0505263157894738, 0.0505263157894738, 0.0496240601503759, 0.0491729323308270;
    maracuja::Spectrum SensitSpectrum;
    SensitSpectrum.setValues(400, 950, Sensitivity);
    assert( Sensitivity.isApprox( SensitSpectrum.getData() ) );

    // MSImage
    maracuja::MSImage imageTest;
    imageTest.init();

    // Filters
    Eigen::VectorXd Filter1(551);
    Filter1 << 0.480610504200000, 0.481150550800000, 0.481869354200000, 0.483012580900000, 0.483803978000000, 0.484906234700000, 0.486323547400000, 0.487385940600000, 0.488922233600000, 0.488309753400000, 0.488286598200000, 0.488982353200000, 0.484850349400000, 0.475781784100000, 0.460184707600000, 0.437950935400000, 0.406959343000000, 0.368429260300000, 0.324199333200000, 0.277357692700000, 0.231475715600000, 0.188953704800000, 0.151315126400000, 0.119803066300000, 0.0937653350800000, 0.0731791257900000, 0.0570456218700000, 0.0445695495600000, 0.0350337290800000, 0.0275680851900000, 0.0218930697400000, 0.0175243425400000, 0.0141054821000000, 0.0114533329000000, 0.00935966253300000, 0.00767080068600000, 0.00632954537900000, 0.00520152151600000, 0.00426660478100000, 0.00347497075800000, 0.00279554247900000, 0.00221557498000000, 0.00171665549300000, 0.00130597814900000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    maracuja::Spectrum F1Spectrum;
    F1Spectrum.setValues(400, 950, Filter1);
    assert( Filter1.isApprox( F1Spectrum.getData() ) );
    maracuja::Channel F1Channel;
    F1Channel.setValues(1, F1Spectrum, SensitSpectrum, "Filter 1");
    assert( F1Channel.getFilter().getData().isApprox( F1Spectrum.getData() ) );
    assert( F1Channel.getSensor().getData().isApprox( SensitSpectrum.getData() ) );
    imageTest.addChannel(F1Channel);

    Eigen::VectorXd Filter2(551);
    Filter2 << 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00146204203400000, 0.00315466016500000, 0.00678514123000000, 0.0143643808400000, 0.0300173306500000, 0.0596992111200000, 0.110091600400000, 0.181809520700000, 0.263378257800000, 0.337606048600000, 0.390636520400000, 0.426546554600000, 0.459470214800000, 0.501245803800000, 0.554974746700000, 0.616252174400000, 0.670852127100000, 0.706304473900000, 0.719801178000000, 0.717603530900000, 0.711896514900000, 0.710831527700000, 0.716983642600000, 0.728174285900000, 0.739736938500000, 0.747461700400000, 0.749691391000000, 0.746639938400000, 0.739436035200000, 0.729354629500000, 0.715807189900000, 0.698984985400000, 0.679526138300000, 0.658287506100000, 0.637554359400000, 0.620818557700000, 0.610143661500000, 0.606950569200000, 0.611126060500000, 0.619224433900000, 0.625530548100000, 0.621171188400000, 0.595484390300000, 0.543018417400000, 0.465607452400000, 0.375118370100000, 0.283364982600000, 0.203124275200000, 0.139681663500000, 0.0939799213400000, 0.0625847864200000, 0.0411968135800000, 0.0271958971000000, 0.0180801057800000, 0.0120595753200000, 0.00811973094900000, 0.00552618205500000, 0.00380207508800000, 0.00265549480900000, 0.00186753943600000, 0.00133273243900000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    maracuja::Spectrum F2Spectrum;
    F2Spectrum.setValues(400, 950, Filter2);
    assert( Filter2.isApprox( F2Spectrum.getData() ) );
    maracuja::Channel F2Channel;
    F2Channel.setValues(2, F2Spectrum, SensitSpectrum, "Filter 2");
    imageTest.addChannel(F2Channel);

    Eigen::VectorXd Filter3(551);
    Filter3 << 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00122505091100000, 0.00244666293300000, 0.00501194953900000, 0.0104630351100000, 0.0219941854500000, 0.0462253284500000, 0.0946668529500000, 0.180547065700000, 0.305938835100000, 0.447611923200000, 0.570035934400000, 0.641070327800000, 0.669430542000000, 0.674656066900000, 0.671306991600000, 0.667128295900000, 0.666352462800000, 0.670495224000000, 0.679106903100000, 0.691448745700000, 0.705677566500000, 0.719779663100000, 0.732710723900000, 0.742596893300000, 0.748927688600000, 0.751937484700000, 0.752867507900000, 0.752254104600000, 0.750877990700000, 0.750139389000000, 0.749361343400000, 0.749530563400000, 0.749867706300000, 0.749796600300000, 0.749592285200000, 0.747948837300000, 0.745149536100000, 0.740310211200000, 0.734094390900000, 0.725658187900000, 0.715704650900000, 0.703255081200000, 0.689470977800000, 0.674533538800000, 0.658859481800000, 0.644877166700000, 0.633101272600000, 0.624691848800000, 0.616581802400000, 0.594958305400000, 0.537778091400000, 0.432275695800000, 0.295466480300000, 0.173660545300000, 0.0780722284300000, 0.0458301639600000, 0.0232101893400000, 0.0119428002800000, 0.00635969102400000, 0.00350937217500000, 0.00201128602000000, 0.00118885070100000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    maracuja::Spectrum F3Spectrum;
    F3Spectrum.setValues(400, 950, Filter3);
    assert( Filter3.isApprox( F3Spectrum.getData() ) );
    maracuja::Channel F3Channel;
    F3Channel.setValues(3, F3Spectrum, SensitSpectrum, "Filter 3");
    imageTest.addChannel(F3Channel);

    Eigen::VectorXd Filter4(551);
    Filter4 << 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00146227508800000, 0.00227412328100000, 0.00363548457600000, 0.00594405829900000, 0.00996797561600000, 0.0171008741900000, 0.0301526927900000, 0.0556089782700000, 0.104272470500000, 0.190821495100000, 0.312971706400000, 0.431185417200000, 0.499341125500000, 0.507570266700000, 0.488546867400000, 0.471195983900000, 0.465869026200000, 0.472625923200000, 0.489141922000000, 0.512515487700000, 0.540489616400000, 0.571140174900000, 0.602469635000000, 0.631372795100000, 0.655965499900000, 0.674461746200000, 0.686140213000000, 0.690967636100000, 0.690300598100000, 0.685872650100000, 0.679007949800000, 0.670642166100000, 0.661679077100000, 0.652571106000000, 0.644729919400000, 0.639499893200000, 0.638314895600000, 0.641475677500000, 0.648160095200000, 0.656032028200000, 0.661479263300000, 0.661303405800000, 0.653197479200000, 0.636560249300000, 0.613830757100000, 0.587445755000000, 0.558088111900000, 0.523640403700000, 0.479808502200000, 0.420853271500000, 0.346889152500000, 0.267182502700000, 0.192858486200000, 0.132804689400000, 0.0892383289300000, 0.0593049383200000, 0.0394389033300000, 0.0265750312800000, 0.0183033645200000, 0.0127608633000000, 0.00909321844600000, 0.00661062002200000, 0.00488646805300000, 0.00367302417800000, 0.00279440343400000, 0.00215202689200000, 0.00167861923600000, 0.00132178753600000, 0.00104838654400000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    maracuja::Spectrum F4Spectrum;
    F4Spectrum.setValues(400, 950, Filter4);
    assert( Filter4.isApprox( F4Spectrum.getData() ) );
    maracuja::Channel F4Channel;
    F4Channel.setValues(4, F4Spectrum, SensitSpectrum, "Filter 4");
    imageTest.addChannel(F4Channel);

    Eigen::VectorXd Filter5(551);
    Filter5 << 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00105003178100000, 0.00102949805600000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00131782531700000, 0.00192825421700000, 0.00289690613700000, 0.00448208808900000, 0.00715082407000000, 0.0117741382100000, 0.0204212141000000, 0.0370717096300000, 0.0710173034700000, 0.141418056500000, 0.274617614700000, 0.471901512100000, 0.656702117900000, 0.736180877700000, 0.712076568600000, 0.654398345900000, 0.612482719400000, 0.596374168400000, 0.601851577800000, 0.622440338100000, 0.651477661100000, 0.684079437300000, 0.715680542000000, 0.742244339000000, 0.762263488800000, 0.774789733900000, 0.779908752400000, 0.778395614600000, 0.772097930900000, 0.761940155000000, 0.748262558000000, 0.732323684700000, 0.715332412700000, 0.697565765400000, 0.680449066200000, 0.664925231900000, 0.651306991600000, 0.640553588900000, 0.632725639300000, 0.628119659400000, 0.626316490200000, 0.625401001000000, 0.622365188600000, 0.612033653300000, 0.587359504700000, 0.540656738300000, 0.469145965600000, 0.380325889600000, 0.287942161600000, 0.206346111300000, 0.141379547100000, 0.0949416065200000, 0.0633775758700000, 0.0425242996200000, 0.0288586139700000, 0.0197964084100000, 0.0138129723100000, 0.00981921255600000, 0.00705643117400000, 0.00515846610100000, 0.00382257223100000, 0.00286383777900000, 0.00218161016700000, 0.00167434170800000, 0.00130222708000000, 0.00102467663600000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    maracuja::Spectrum F5Spectrum;
    F5Spectrum.setValues(400, 950, Filter5);
    assert( Filter5.isApprox( F5Spectrum.getData() ) );
    maracuja::Channel F5Channel;
    F5Channel.setValues(5, F5Spectrum, SensitSpectrum, "Filter 5");
    imageTest.addChannel(F5Channel);

    Eigen::VectorXd Filter6(551);
    Filter6 << 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00107889875800000, 0.00149064496200000, 0.00209594652100000, 0.00300988256900000, 0.00441726863400000, 0.00659322619400000, 0.0101633358000000, 0.0160873293900000, 0.0263496112800000, 0.0447834539400000, 0.0783147954900000, 0.140912723500000, 0.248939514200000, 0.405202179000000, 0.575555152900000, 0.697319870000000, 0.735127182000000, 0.712117538500000, 0.674790191700000, 0.646312027000000, 0.632586822500000, 0.631464538600000, 0.639795761100000, 0.653236084000000, 0.668837509200000, 0.683345565800000, 0.694527511600000, 0.701081008900000, 0.702214508100000, 0.698596801800000, 0.690368194600000, 0.679033126800000, 0.666421127300000, 0.653199996900000, 0.641317749000000, 0.631291618300000, 0.624430770900000, 0.621520805400000, 0.622645683300000, 0.628179664600000, 0.638518142700000, 0.653156662000000, 0.671820526100000, 0.693387527500000, 0.716252594000000, 0.737640762300000, 0.752605972300000, 0.754939270000000, 0.735817337000000, 0.687902679400000, 0.608017845200000, 0.503586463900000, 0.390007438700000, 0.285101528200000, 0.200377254500000, 0.136356086700000, 0.0921047973600000, 0.0622258615500000, 0.0422894620900000, 0.0290302157400000, 0.0201215887100000, 0.0141591131700000, 0.0101546239900000, 0.00739957571000000, 0.00546510815600000, 0.00408280313000000, 0.00308833301100000, 0.00237126037500000, 0.00182706460400000, 0.00142351940300000, 0.00112091042100000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    maracuja::Spectrum F6Spectrum;
    F6Spectrum.setValues(400, 950, Filter6);
    assert( Filter6.isApprox( F6Spectrum.getData() ) );
    maracuja::Channel F6Channel;
    F6Channel.setValues(6, F6Spectrum, SensitSpectrum, "Filter 6");
    imageTest.addChannel(F6Channel);

    Eigen::VectorXd Filter7(551);
    Filter7 << 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00127632319900000, 0.00173192843800000, 0.00237449303300000, 0.00331294775000000, 0.00470024287700000, 0.00676820874200000, 0.00994052529300000, 0.0149132418600000, 0.0229180526700000, 0.0360359072700000, 0.0575125837300000, 0.0938177490200000, 0.152961883500000, 0.245398349800000, 0.374134101900000, 0.520022621200000, 0.649666290300000, 0.729986572300000, 0.759654998800000, 0.757423172000000, 0.743989868200000, 0.730738830600000, 0.722248992900000, 0.719275360100000, 0.719700241100000, 0.722403793300000, 0.725859832800000, 0.729186554000000, 0.731548461900000, 0.732095260600000, 0.731598205600000, 0.729810562100000, 0.727182235700000, 0.723612136800000, 0.719819870000000, 0.716712799100000, 0.713155441300000, 0.710857162500000, 0.709262237500000, 0.708332748400000, 0.708736801100000, 0.709554595900000, 0.711636734000000, 0.714858093300000, 0.718769989000000, 0.723815078700000, 0.730378189100000, 0.737973785400000, 0.744743423500000, 0.747846221900000, 0.741374969500000, 0.716235199000000, 0.663682632400000, 0.579788322400000, 0.474308662400000, 0.363348884600000, 0.263146457700000, 0.182183132200000, 0.123501424800000, 0.0837004947700000, 0.0567161274000000, 0.0389788484600000, 0.0271691632300000, 0.0191923749400000, 0.0138173782800000, 0.0100555264900000, 0.00743013083900000, 0.00555888116400000, 0.00420986115900000, 0.00323173075900000, 0.00249908909200000, 0.00195686981100000, 0.00154523730300000, 0.00123379252900000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    maracuja::Spectrum F7Spectrum;
    F7Spectrum.setValues(400, 950, Filter7);
    assert( Filter7.isApprox( F7Spectrum.getData() ) );
    maracuja::Channel F7Channel;
    F7Channel.setValues(7, F7Spectrum, SensitSpectrum, "Filter 7");
    imageTest.addChannel(F7Channel);

    Eigen::VectorXd Filter8(551);
    Filter8 << 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00105382911900000, 0.00159694656700000, 0.00247014030800000, 0.00394650220900000, 0.00658716023000000, 0.0115133249800000, 0.0213277459100000, 0.0428206968300000, 0.0907396793400000, 0.192917709400000, 0.357962913500000, 0.509839286800000, 0.555303382900000, 0.504475059500000, 0.439482078600000, 0.400928993200000, 0.390813713100000, 0.402896537800000, 0.432635040300000, 0.475356712300000, 0.529320106500000, 0.587106246900000, 0.642706680300000, 0.689609375000000, 0.724999389600000, 0.748338546800000, 0.762060394300000, 0.769339523300000, 0.773963241600000, 0.777074050900000, 0.779376297000000, 0.781450653100000, 0.782004928600000, 0.780621719400000, 0.777152862500000, 0.772045822100000, 0.765675048800000, 0.759163284300000, 0.752983856200000, 0.748093109100000, 0.745259017900000, 0.742887039200000, 0.741512680100000, 0.739649200400000, 0.736681366000000, 0.730802383400000, 0.720295105000000, 0.703277053800000, 0.673616485600000, 0.624967346200000, 0.550945472700000, 0.456644210800000, 0.352769508400000, 0.253122749300000, 0.172791156800000, 0.114041261700000, 0.0741702604300000, 0.0483103370700000, 0.0318098259000000, 0.0212375736200000, 0.0144349885000000, 0.00997504055500000, 0.00699718594600000, 0.00498628020300000, 0.00361153632400000, 0.00266102612000000, 0.00197867006100000, 0.00149165257800000, 0.00113861404400000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    maracuja::Spectrum F8Spectrum;
    F8Spectrum.setValues(400, 950, Filter8);
    assert( Filter8.isApprox( F8Spectrum.getData() ) );
    maracuja::Channel F8Channel;
    F8Channel.setValues(8, F8Spectrum, SensitSpectrum, "Filter 8");
    imageTest.addChannel(F8Channel);

    Eigen::VectorXd Filter9(551);
    Filter9 << 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00128793373700000, 0.00179064780500000, 0.00251339674000000, 0.00357786238200000, 0.00521469533400000, 0.00770527482000000, 0.0116020798700000, 0.0178734695900000, 0.0280551195100000, 0.0450587558700000, 0.0737791633600000, 0.121070900000000, 0.195939159400000, 0.304529972100000, 0.439925308200000, 0.576995239300000, 0.685342407200000, 0.754576644900000, 0.787847518900000, 0.801781692500000, 0.805984344500000, 0.807803955100000, 0.807257995600000, 0.807233200100000, 0.805429306000000, 0.803118743900000, 0.799777984600000, 0.796211624100000, 0.793897628800000, 0.791738281300000, 0.785050888100000, 0.783969268800000, 0.782764511100000, 0.779291534400000, 0.774793243400000, 0.768504562400000, 0.758864135700000, 0.746743698100000, 0.730831298800000, 0.713307876600000, 0.693160934400000, 0.672017669700000, 0.650943374600000, 0.633826026900000, 0.619103241000000, 0.607291030900000, 0.596301956200000, 0.584064674400000, 0.568451271100000, 0.549421234100000, 0.526183052100000, 0.496397476200000, 0.460256500200000, 0.415806579600000, 0.366697998000000, 0.319324798600000, 0.277104225200000, 0.240270023300000, 0.208744869200000, 0.183606529200000, 0.160814380600000, 0.141282901800000, 0.125682458900000, 0.112276573200000, 0.0986166381800000, 0.0841775131200000, 0.0707104301500000, 0.0582929945000000, 0.0473422908800000, 0.0376969862000000, 0.0290673303600000, 0.0217853641500000, 0.0155173850100000, 0.0104010617700000, 0.00657099068200000, 0.00405022442300000, 0.00251605182900000, 0.00159174934000000, 0.00107269078500000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    maracuja::Spectrum F9Spectrum;
    F9Spectrum.setValues(400, 950, Filter9);
    assert( Filter9.isApprox( F9Spectrum.getData() ) );
    maracuja::Channel F9Channel;
    F9Channel.setValues(9, F9Spectrum, SensitSpectrum, "Filter 9");
    imageTest.addChannel(F9Channel);

    Eigen::VectorXd Filter10(551);
    Filter10 << 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00146128043500000, 0.00246054112900000, 0.00415280729500000, 0.00692803800100000, 0.0111086893100000, 0.0170590353000000, 0.0243831920600000, 0.0331512737300000, 0.0431006765400000, 0.0537262249000000, 0.0660038805000000, 0.0801821041100000, 0.0956482410400000, 0.113027887300000, 0.132419023500000, 0.153848190300000, 0.176384067500000, 0.203192482000000, 0.235913391100000, 0.272241630600000, 0.317417373700000, 0.367812767000000, 0.419797020000000, 0.469336166400000, 0.511705207800000, 0.544606399500000, 0.568605728100000, 0.586778030400000, 0.599159698500000, 0.609427948000000, 0.621191330000000, 0.635307846100000, 0.652177200300000, 0.669734726000000, 0.685923996000000, 0.699719696000000, 0.711255111700000, 0.719391632100000, 0.723696823100000, 0.727486343400000, 0.729857482900000, 0.730959625200000, 0.732409896900000, 0.733117828400000, 0.733862915000000, 0.734493026700000, 0.733977584800000, 0.733471679700000, 0.731532287600000, 0.730010757400000, 0.728344879200000, 0.726686630200000, 0.725596008300000, 0.726872100800000, 0.728514404300000, 0.728029327400000, 0.720641250600000, 0.700706634500000, 0.658830947900000, 0.595476379400000, 0.517022247300000, 0.432866439800000, 0.351859626800000, 0.283616924300000, 0.229442462900000, 0.186150779700000, 0.152761507000000, 0.127132844900000, 0.105610446900000, 0.0886255359600000, 0.0753198242200000, 0.0648734808000000, 0.0583554601700000, 0.0501028919200000, 0.0404668951000000, 0.0291467547400000, 0.0203587913500000, 0.0134728419800000, 0.00865882754300000, 0.00548264682300000, 0.00352293849000000, 0.00227137073900000, 0.00152020722600000, 0.00105714097600000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    maracuja::Spectrum F10Spectrum;
    F10Spectrum.setValues(400, 950, Filter10);
    assert( Filter10.isApprox( F10Spectrum.getData() ) );
    maracuja::Channel F10Channel;
    F10Channel.setValues(10, F10Spectrum, SensitSpectrum, "Filter 10");
    imageTest.addChannel(F10Channel);

    // coefficients' calculation
    std::vector<std::vector<double> > coeffs;
    coeffs = imageTest.initialization(RGB);

    std::cout << "Hello Test!" << std::endl;
    for (unsigned couleur = 0; couleur < RGB.size(); couleur++)
    {
        for (unsigned i = 0; i < imageTest.getChannelsNumber(); i++)
        {
            std::cout << coeffs[couleur][i];
            std::cout << " ";
        }
        std::cout << std::endl;
    }

    toRGB( std::string(argv[1]) );

    return 0;
}
